; -*- mode: CIL; fill-column: 75; indent-tabs-mode: nil; tab-width: 4 -*-

; Users policy
;
; 1. Users name space
;       Users common_login_user name space
;       Users common_user name space
;       Users generic_cache name space
;       Users generic_config name space
;       Users generic_data name space
;       Users generic_home name space
;       Users generic_tmp name space
;       Users generic_tmpfs name space
;       Users home_cache_file name space
;       Users home_cert name space
;       Users home_commands name space
;       Users home_config_file name space
;       Users home_data_file name space
;       Users home_dir name space
;       Users home_file name space
;       Users home_font name space
;           Users home_font cache name space
;           Users home_font config name space
;           Users home_font data name space
;       Users home_history name space
;       Users home_shellrc name space
;       Users login_user name space
;       Users mail_spool name space
;       Users priv_login_user name space
;       Users priv_user name space
;       Users terminals name space
;           Users terminals pty name space
;           Users terminals tty name space
;       Users unpriv_login_user name space
;       Users unpriv_user name space
;       Users user_tmp_file name space
;       Users user_tmpfs_file name space

(block users

    ;
    ; Users common_login_user name space
    ;

    (block common_login_user

        ;
        ; common_login_user macros
        ;

        (blockinherit common_user.subj_macro_template)

        ;
        ; common_login_user policy
        ;

        (blockinherit subj_policy_template)

        ;
        ; common_login_user templates
        ;

        (block subj_policy_template

            ;
            ; users.common_login_user.subj_policy_template policy
            ;

            (blockabstract subj_policy_template)

            (typeattribute subj_type_attribute)

            (allow subj_type_attribute self create_unix_dgram_socket_perms)

            (call users.generic_cache.home_dir_obj_type_transition
                (
                    subj_type_attribute
                )
            )

            (call users.generic_cache.manage
                (
                    subj_type_attribute
                )
            )
            (call users.generic_cache.relabel
                (
                    subj_type_attribute
                )
            )

            (call users.generic_config.home_dir_obj_type_transition
                (
                    subj_type_attribute
                )
            )

            (call users.generic_config.manage
                (
                    subj_type_attribute
                )
            )
            (call users.generic_config.relabel
                (
                    subj_type_attribute
                )
            )

            (call users.generic_data.home_dir_obj_type_transition
                (
                    subj_type_attribute
                )
            )

            (call users.generic_data.manage
                (
                    subj_type_attribute
                )
            )
            (call users.generic_data.relabel
                (
                    subj_type_attribute
                )
            )

            (call users.generic_home.home_dir_obj_type_transition
                (
                    subj_type_attribute dir "*"
                )
            )
            (call users.generic_home.home_dir_obj_type_transition
                (
                    subj_type_attribute fifo_file "*"
                )
            )
            (call users.generic_home.home_dir_obj_type_transition
                (
                    subj_type_attribute file "*"
                )
            )
            (call users.generic_home.home_dir_obj_type_transition
                (
                    subj_type_attribute lnk_file "*"
                )
            )
            (call users.generic_home.home_dir_obj_type_transition
                (
                    subj_type_attribute sock_file "*"
                )
            )

            (call users.generic_home.manage
                (
                    subj_type_attribute
                )
            )
            (call users.generic_home.relabel
                (
                    subj_type_attribute
                )
            )

            (call users.generic_tmp.generic_var_tmp_obj_type_transition
                (
                    subj_type_attribute dir "*"
                )
            )
            (call users.generic_tmp.generic_var_tmp_obj_type_transition
                (
                    subj_type_attribute fifo_file "*"
                )
            )
            (call users.generic_tmp.generic_var_tmp_obj_type_transition
                (
                    subj_type_attribute file "*"
                )
            )
            (call users.generic_tmp.generic_var_tmp_obj_type_transition
                (
                    subj_type_attribute lnk_file "*"
                )
            )
            (call users.generic_tmp.generic_var_tmp_obj_type_transition
                (
                    subj_type_attribute sock_file "*"
                )
            )

            (call users.generic_tmp.manage
                (
                    subj_type_attribute
                )
            )
            (call users.generic_tmp.relabel
                (
                    subj_type_attribute
                )
            )

            (call users.generic_tmpfs.manage
                (
                    subj_type_attribute
                )
            )

            (call users.generic_tmpfs.tmpfs_obj_type_transition
                (
                    subj_type_attribute dir "*"
                )
            )
            (call users.generic_tmpfs.tmpfs_obj_type_transition
                (
                    subj_type_attribute fifo_file "*"
                )
            )
            (call users.generic_tmpfs.tmpfs_obj_type_transition
                (
                    subj_type_attribute file "*"
                )
            )
            (call users.generic_tmpfs.tmpfs_obj_type_transition
                (
                    subj_type_attribute lnk_file "*"
                )
            )
            (call users.generic_tmpfs.tmpfs_obj_type_transition
                (
                    subj_type_attribute sock_file "*"
                )
            )

            (call users.generic_tmpfs.relabel
                (
                    subj_type_attribute
                )
            )

            (call users.home_cert.home_dir_obj_type_transition
                (
                    subj_type_attribute
                )
            )

            (call users.home_cert.manage
                (
                    subj_type_attribute
                )
            )
            (call users.home_cert.relabel
                (
                    subj_type_attribute
                )
            )

            (call users.home_commands.entry
                (
                    subj_type_attribute
                )
            )

            (call users.home_commands.execute
                (
                    subj_type_attribute
                )
            )

            (call users.home_commands.generic_data_obj_type_transition
                (
                    subj_type_attribute
                )
            )

            (call users.home_commands.manage
                (
                    subj_type_attribute
                )
            )
            (call users.home_commands.relabel
                (
                    subj_type_attribute
                )
            )

            (call users.home_font.cache.generic_cache_obj_type_transition
                (
                    subj_type_attribute
                )
            )

            (call users.home_font.cache.home_dir_obj_type_transition
                (
                    subj_type_attribute
                )
            )

            (call users.home_font.cache.manage
                (
                    subj_type_attribute
                )
            )
            (call users.home_font.cache.relabel
                (
                    subj_type_attribute
                )
            )

            (call users.home_font.config.generic_config_obj_type_transition
                (
                    subj_type_attribute
                )
            )

            (call users.home_font.config.home_dir_obj_type_transition
                (
                    subj_type_attribute
                )
            )

            (call users.home_font.config.manage
                (
                    subj_type_attribute
                )
            )
            (call users.home_font.config.relabel
                (
                    subj_type_attribute
                )
            )

            (call users.home_font.data.generic_data_obj_type_transition
                (
                    subj_type_attribute
                )
            )

            (call users.home_font.data.home_dir_obj_type_transition
                (
                    subj_type_attribute
                )
            )

            (call users.home_font.data.manage
                (
                    subj_type_attribute
                )
            )
            (call users.home_font.data.relabel
                (
                    subj_type_attribute
                )
            )

            (call users.home_history.home_dir_obj_type_transition
                (
                    subj_type_attribute
                )
            )

            (call users.home_history.manage_files
                (
                    subj_type_attribute
                )
            )
            (call users.home_history.relabel_files
                (
                    subj_type_attribute
                )
            )

            (call users.home_shellrc.home_dir_obj_type_transition
                (
                    subj_type_attribute
                )
            )

            (call users.home_shellrc.manage_files
                (
                    subj_type_attribute
                )
            )
            (call users.home_shellrc.relabel_files
                (
                    subj_type_attribute
                )
            )

            (call users.mail_spool.rw_files
                (
                    subj_type_attribute
                )
            )

            (call users.terminals.pty.user_pty
                (
                    subj_type_attribute
                )
            )
            (call users.terminals.tty.user_tty
                (
                    subj_type_attribute
                )
            )

            (call ibac_user_exemption_target_subj_type
                (
                    subj_type_attribute
                )
            )
            (call rbac_user_exemption_target_subj_type
                (
                    subj_type_attribute
                )
            )

            (call sys.kernel_sysctl.read_files
                (
                    subj_type_attribute
                )
            )
            (call sys.net_proc.read_files
                (
                    subj_type_attribute
                )
            )

            (call files.generic_config.read
                (
                    subj_type_attribute
                )
            )
            (call files.generic_data.read
                (
                    subj_type_attribute
                )
            )
            (call files.mnt.list
                (
                    subj_type_attribute
                )
            )

            (call fs.sysfs.getattr_fs
                (
                    subj_type_attribute
                )
            )
            (call fs.tmpfs.list
                (
                    subj_type_attribute
                )
            )

            (call sec.validate_context
                (
                    subj_type_attribute
                )
            )

            ;;(call hostname.execute
            ;;    (
            ;;        subj_type_attribute
            ;;    )
            ;;)

            (call misc.font.client_subj_type
                (
                    subj_type_attribute
                )
            )
            (call misc.mime.client_subj_type
                (
                    subj_type_attribute
                )
            )

            ;;(call seutils.config.read_files
            ;;    (
            ;;        subj_type_attribute
            ;;    )
            ;;)
            ;;(call seutils.default_context.read_files
            ;;    (
            ;;        subj_type_attribute
            ;;    )
            ;;)
            ;;(call seutils.file_context.read_files
            ;;    (
            ;;        subj_type_attribute
            ;;    )
            ;;)
            ;;(call seutils.setfiles.execute
            ;;    (
            ;;        subj_type_attribute
            ;;    )
            ;;)

            (optional common_login_user_optional_mcstransd
                (call mcstransd.contains
                    (
                        subj_type_attribute
                    )
                )
            )
        )

        (block subj_template

            ;
            ; users.common_login_user.subj_template policy
            ;

            (blockabstract subj_template)

            (blockinherit users.common_user.subj_template)

            (user id)
            (userrole id role)

            (userlevel id systemlow)
            (userrange id
                (
                    systemlow
                    systemlow
                )
            )

            (call users.common_login_user.subj_type
                (
                    subj
                )
            )

            (call sys.roleallow_role
                (
                    role
                )
            )
        )
    )

    ;
    ; Users common_user name space
    ;

    (block common_user

        ;
        ; common_user macros
        ;

        (blockinherit subj_macro_template)

        ;
        ; common_user policy
        ;

        (blockinherit subj_policy_template)

        ;
        ; common_user templates
        ;

        (block subj_macro_template

            ;
            ; users.common_user.subj_macro_template macros
            ;

            (blockinherit subj.common_subj.subj_macro_template)

            (macro manual_subj_type_transition ((type ARG1))
                (allow ARG1 self
                    (process
                        (
                            setexec
                        )
                    )
                )

                (call dontaudit_noatsecure
                    (
                        ARG1
                    )
                )
                (call dontaudit_rlimitinh
                    (
                        ARG1
                    )
                )
                (call dontaudit_siginh
                    (
                        ARG1
                    )
                )

                (call signal
                    (
                        ARG1
                    )
                )
                (call transition
                    (
                        ARG1
                    )
                )

                (allow subj_type_attribute ARG1
                    (process
                        (
                            sigchld
                            signal
                            signull
                        )
                    )
                )
            )

            ;
            ; users.common_user.subj_macro_template policy
            ;

            (blockabstract subj_macro_template)
        )

        (block subj_policy_template

            ;
            ; users.common_user.subj_policy_template policy
            ;

            (blockabstract subj_policy_template)

            (typeattribute subj_type_attribute)

            (allow subj_type_attribute self
                (process
                    (
                        getattr
                        getsched
                        ptrace
                        setpgid
                        setsched
                    )
                )
            )
            (allow subj_type_attribute self
                create_unix_stream_socket_perms)

            (call terminals.rw_inherited_chr_files
                (
                    subj_type_attribute
                )
            )

            (call sys.cpu_online_sysfs.read_files
                (
                    subj_type_attribute
                )
            )
            (call sys.mountpoint.dontaudit_list
                (
                    subj_type_attribute
                )
            )
            (call sys.node_online_sysfs.read_files
                (
                    subj_type_attribute
                )
            )
            (call sys.proc_file.dontaudit_read_files
                (
                   subj_type_attribute
                )
            )
            (call sys.sysctl_file.dontaudit_read
                (
                    subj_type_attribute
                )
            )
            (call sys.sysfs_file.dontaudit_read
                (
                    subj_type_attribute
                )
            )

            (call cmd.generic_commands.entry
                (
                    subj_type_attribute
                )
            )
            (call cmd.generic_commands.execute
                (
                    subj_type_attribute
                )
            )
            (call cmd.generic_commands.list
                (
                    subj_type_attribute
                )
            )
            (call cmd.shell.entry
                (
                    subj_type_attribute
                )
            )
            (call cmd.shell.execute
                (
                    subj_type_attribute
                )
            )

            (call dev.urandom.read_chr_files
                (
                    subj_type_attribute
                )
            )

            (call fs.dontaudit_getattr_fs
                (
                    subj_type_attribute
                )
            )
            (call fs.xattr.getattr_fs
                (
                    subj_type_attribute
                )
            )
            (call fs.proc.read
                (
                    subj_type_attribute
                )
            )

            (call sec.compute_create_context
                (
                    subj_type_attribute
                )
            )
            (call sec.set_fscreate_subj_type
                (
                    subj_type_attribute
                )
            )

            (call subj.common_subj.dontaudit_read_state
                (
                    subj_type_attribute
                )
            )
            (call subj.interactive_fd_subj_type
                (
                    subj_type_attribute
                )
            )

            (call misc.man.read
                (
                    subj_type_attribute
                )
            )
            (call misc.passwd.read_files
                (
                    subj_type_attribute
                )
            )
            (call misc.terminfo.client_subj_type
                (
                    subj_type_attribute
                )
            )
            (call misc.utmp.read_files
                (
                    subj_type_attribute
                )
            )

            ;;(call nss.read_files
            ;;    (
            ;;        subj_type_attribute
            ;;    )
            ;;)

            (optional common_user_optional_ldconfig
                (call ldconfig.execute
                    (
                        subj_type_attribute
                    )
                )
            )
        )

        (block subj_stub

            ;
            ; users.common_user.subj_stub policy
            ;

            (blockabstract subj_stub)

            (blockinherit subj.common_subj.subj_template)

            (call users.common_user.subj_type
                (
                    subj
                )
            )
        )

        (block subj_template

            ;
            ; users.common_user.subj_template policy
            ;

            (macro dontaudit_noatsecure ((type ARG1))
                (dontaudit ARG1 subj
                    (process
                        (
                            noatsecure
                        )
                    )
                )
            )

            (macro dontaudit_read_state ((type ARG1))
                (dontaudit ARG1 subj
                    (process_state
                        (
                            read
                        )
                    )
                )
            )

            (macro dontaudit_rlimitinh ((type ARG1))
                (dontaudit ARG1 subj
                    (process
                        (
                            rlimitinh
                        )
                    )
                )
            )

            (macro dontaudit_siginh ((type ARG1))
                (dontaudit ARG1 subj
                    (process
                        (
                            siginh
                        )
                    )
                )
            )

            (macro append_inherited_fifo_files ((type ARG1))
                (allow ARG1 subj append_inherited_fifo_file_perms)
                (call use_fd
                    (
                        ARG1
                    )
                )
            )

            (macro append_inherited_unix_stream_sockets ((type ARG1))
                (allow ARG1 subj append_inherited_unix_stream_socket_perms)
                (call use_fd
                    (
                        ARG1
                    )
                )
            )

            (macro generic_commands_auto_subj_type_transition ((type ARG1))
                (call
                    cmd.generic_commands.cmd_file_auto_subj_type_transition
                        (
                            ARG1 subj
                        )
                )

                (call dontaudit_noatsecure
                    (
                        ARG1
                    )
                )
                (call dontaudit_rlimitinh
                    (
                        ARG1
                    )
                )
                (call dontaudit_siginh
                    (
                        ARG1
                    )
                )

                (call signal
                    (
                        ARG1
                    )
                )
                (call transition
                    (
                        ARG1
                    )
                )

                (allow subj ARG1
                    (process
                        (
                            sigchld
                            signal
                            signull
                        )
                    )
                )
            )

            (macro create_keyring ((type ARG1))
                (allow ARG1 self
                    (process
                        (
                            setkeycreate
                        )
                    )
                )
                (allow ARG1 subj create_key_perms)
            )

            (macro dyntransition ((type ARG1))
                (allow ARG1 subj
                    (process
                        (
                            dyntransition
                        )
                    )
                )
                (call subj.dyntransition_subj_type
                    (
                        ARG1
                    )
                )
            )

            (macro getattr ((type ARG1))
                (allow ARG1 subj
                    (process
                        (
                            getattr
                        )
                    )
                )
            )

            (macro getpgid ((type ARG1))
                (allow ARG1 subj
                    (process
                        (
                            getpgid
                        )
                    )
                )
            )

            (macro getsched ((type ARG1))
                (allow ARG1 subj
                    (process
                        (
                            getsched
                        )
                    )
                )
            )

            (macro getsession ((type ARG1))
                (allow ARG1 subj
                    (process
                        (
                            getsession
                        )
                    )
                )
            )

            (macro home_commands_auto_subj_type_transition ((type ARG1))
                (call
                    users.home_commands.home_file_auto_subj_type_transition
                        (
                            ARG1 subj
                        )
                )

                (call dontaudit_noatsecure
                    (
                        ARG1
                    )
                )
                (call dontaudit_rlimitinh
                    (
                        ARG1
                    )
                )
                (call dontaudit_siginh
                    (
                        ARG1
                    )
                )

                (call signal
                    (
                        ARG1
                    )
                )
                (call transition
                    (
                        ARG1
                    )
                )

                (allow subj ARG1
                    (process
                        (
                            sigchld
                            signal
                            signull
                        )
                    )
                )
            )

            (macro link_keyring ((type ARG1))
                (allow ARG1 subj link_key_perms)
            )

            (macro manual_subj_type_transition ((type ARG1))
                (allow ARG1 self
                    (process
                        (
                            setexec
                        )
                    )
                )

                (call dontaudit_noatsecure
                    (
                        ARG1
                    )
                )
                (call dontaudit_rlimitinh
                    (
                        ARG1
                    )
                )
                (call dontaudit_siginh
                    (
                        ARG1
                    )
                )

                (call signal
                    (
                        ARG1
                    )
                )
                (call transition
                    (
                        ARG1
                    )
                )

                (allow subj ARG1
                    (process
                        (
                            sigchld
                            signal
                            signull
                        )
                    )
                )
            )

            (macro noatsecure ((type ARG1))
                (allow ARG1 subj
                    (process
                        (
                            noatsecure
                        )
                    )
                )
            )

            (macro ps ((type ARG1))
                (allow ARG1 subj
                    (state
                        (
                            ps
                        )
                    )
                )
            )

            (macro ptrace ((type ARG1))
                (allow ARG1 subj
                    (process
                        (
                            ptrace
                        )
                    )
                )
            )

            (macro read_state ((type ARG1))
                (allow ARG1 subj
                    (state
                        (
                            read
                        )
                    )
                )
            )

            (macro rlimitinh ((type ARG1))
                (allow ARG1 subj
                    (process
                        (
                        rlimitinh
                        )
                    )
                )
            )

            (macro rw_fifo_files ((type ARG1))
                (allow ARG1 subj rw_fifo_file_perms)
            )

            (macro rw_inherited_fifo_files ((type ARG1))
                (allow ARG1 subj rw_inherited_fifo_file_perms)
                (call use_fd
                    (
                        ARG1
                    )
                )
            )

            (macro rw_inherited_tcp_sockets ((type ARG1))
                (allow ARG1 subj rw_inherited_tcp_socket_perms)
                (call use_fd
                    (
                        ARG1
                    )
                )
            )

            (macro rw_inherited_unix_dgram_sockets ((type ARG1))
                (allow ARG1 subj rw_inherited_unix_dgram_socket_perms)
                (call use_fd
                    (
                        ARG1
                    )
                )
            )

            (macro rw_inherited_unix_stream_sockets ((type ARG1))
                (allow ARG1 subj rw_inherited_unix_stream_socket_perms)
                (call use_fd
                    (
                        ARG1
                    )
                )
            )

            (macro rw_unix_stream_sockets ((type ARG1))
                (allow ARG1 subj rw_unix_stream_socket_perms)
            )

            (macro setkeycreate ((type ARG1))
                (allow ARG1 subj
                    (process
                        (
                            setkeycreate
                        )
                    )
                )
            )

            (macro setpgid ((type ARG1))
                (allow ARG1 subj
                    (process
                        (
                            setpgid
                        )
                    )
                )
            )

            (macro setrlimit ((type ARG1))
                (allow ARG1 subj
                    (process
                        (
                            setrlimit
                        )
                    )
                )
            )

            (macro setsched ((type ARG1))
                (allow ARG1 subj
                    (process
                        (
                            setsched
                        )
                    )
                )
            )

            (macro share ((type ARG1))
                (allow ARG1 subj
                    (process
                        (
                            share
                        )
                    )
                )
            )

            (macro shell_auto_subj_type_transition ((type ARG1))
                (call
                    cmd.shell.cmd_file_auto_subj_type_transition
                        (
                            ARG1 subj
                        )
                )

                (call dontaudit_noatsecure
                    (
                        ARG1
                    )
                )
                (call dontaudit_rlimitinh
                    (
                        ARG1
                    )
                )
                (call dontaudit_siginh
                    (
                        ARG1
                    )
                )

                (call signal
                    (
                        ARG1
                    )
                )
                (call transition
                    (
                        ARG1
                    )
                )

                (allow subj ARG1
                    (process
                        (
                            sigchld
                            signal
                            signull
                        )
                    )
                )
            )

            (macro sigchld ((type ARG1))
                (allow ARG1 subj
                    (process
                        (
                            sigchld
                        )
                    )
                )
            )

            (macro siginh ((type ARG1))
                (allow ARG1 subj
                    (process
                        (
                            siginh
                        )
                    )
                )
            )

            (macro sigkill ((type ARG1))
                (allow ARG1 subj
                    (process
                        (
                            sigkill
                        )
                    )
                )
            )

            (macro signal ((type ARG1))
                (allow ARG2 subj
                    (process
                        (
                            signal
                        )
                    )
                )
            )

            (macro signull ((type ARG1))
                (allow ARG1 subj
                    (process
                        (
                            signull
                        )
                    )
                )
            )

            (macro sigstop ((type ARG1))
                (allow ARG1 subj
                    (process
                        (
                            sigstop
                        )
                    )
                )
            )

            (macro transition ((type ARG1))
                (allow ARG1 subj
                    (process
                        (
                            transition
                        )
                    )
                )
            )

            (macro unix_dgram_socket_sendto ((type ARG1))
                (allow ARG1 self create_unix_dgram_socket_perms)
                (allow ARG1 subj
                    (unix_dgram_socket
                        (
                            sendto
                        )
                    )
                )
            )

            (macro unix_stream_socket_connectto ((type ARG1))
                (allow ARG1 self create_unix_stream_socket_perms)
                (allow ARG1 subj
                    (unix_stream_socket
                        (
                            connectto
                        )
                    )
                )
            )

            (macro use_fd ((type ARG1))
                (allow ARG1 subj
                    (fd
                        (
                            use
                        )
                    )
                )
            )

            ;
            ; users.common_user.subj_template policy
            ;

            (blockabstract subj_template)

            (blockinherit users.common_user.subj_stub)

            (role role)
            (roletype role subj)

            (call sys.role
                (
                    role
                )
            )
        )
    )

    ;
    ; Users generic_cache name space
    ;

    (block generic_cache

        ;
        ; generic_cache contexts
        ;

        (filecon "HOME_DIR/\.cache(/.*)?" any home_cache_file_context)

        ;
        ; generic_cache macros
        ;

        (macro add_entries ((type ARG1))
            (allow ARG1 home_cache_file add_entry_dir_perms)
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro append_files ((type ARG1))
            (allow ARG1 home_cache_file append_file_perms)
            (call search
                (
                    ARG1
                )
            )
        )

        (macro client_subj_type ((type ARG1))
            (typeattributeset client_subj_type_attribute ARG1)
        )

        (macro create ((type ARG1))
            (call create_dirs
                (
                    ARG1
                )
            )
            (call create_files
                (
                    ARG1
                )
            )
            (call create_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro create_dirs ((type ARG1))
            (allow ARG1 home_cache_file
                (dirs
                    (
                        create
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro create_files ((type ARG1))
            (allow ARG1 home_cache_file
                (files
                    (
                        create
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro create_lnk_files ((type ARG1))
            (allow ARG1 home_cache_file
                (lnk_files
                    (
                        create
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro del_entries ((type ARG1))
            (allow ARG1 home_cache_file del_entry_dir_perms)
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro delete ((type ARG1))
            (call delete_dirs
                (
                    ARG1
                )
            )
            (call delete_files
                (
                    ARG1
                )
            )
            (call delete_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro delete_dirs ((type ARG1))
            (allow ARG1 home_cache_file
                (dirs
                    (
                        delete
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro delete_files ((type ARG1))
            (allow ARG1 home_cache_file
                (files
                    (
                        delete
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro delete_lnk_files ((type ARG1))
            (allow ARG1 home_cache_file
                (lnk_files
                    (
                        delete
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro execute ((type ARG1))
            (allow ARG1 home_cache_file exec_file_perms)
            (call search
                (
                    ARG1
                )
            )
        )

        (macro getattr ((type ARG1))
            (call getattr_dirs
                (
                    ARG1
                )
            )
            (call getattr_files
                (
                    ARG1
                )
            )
            (call getattr_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro getattr_dirs ((type ARG1))
            (allow ARG1 home_cache_file
                (dirs
                    (
                        getattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro getattr_files ((type ARG1))
            (allow ARG1 home_cache_file
                (files
                    (
                        getattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro getattr_lnk_files ((type ARG1))
            (allow ARG1 home_cache_file
                (lnk_files
                    (
                        getattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro home_dir_obj_type_transition ((type ARG1))
            (call home_dir.obj_type_transition
                (
                    ARG1 home_cache_file dir ".cache"
                )
            )
        )

        (macro list ((type ARG1))
            (allow ARG1 home_cache_file list_dir_perms)
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro manage ((type ARG1))
            (call manage_dirs
                (
                    ARG1
                )
            )
            (call manage_files
                (
                    ARG1
                )
            )
            (call manage_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro manage_dirs ((type ARG1))
            (allow ARG1 home_cache_file
                (dirs
                    (
                        manage
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro manage_files ((type ARG1))
            (allow ARG1 home_cache_file
                (files
                    (
                        manage
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro manage_lnk_files ((type ARG1))
            (allow ARG1 home_cache_file
                (lnk_files
                    (
                        manage
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro mmap ((type ARG1))
            (allow ARG1 home_cache_file mmap_file_perms)
            (call search
                (
                    ARG1
                )
            )
        )

        (macro obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
            (typetransition ARG1 home_cache_file ARG3 ARG4 ARG2)
            (call rw_dirs
                (
                    ARG1
                )
            )
        )

        (macro read ((type ARG1))
            (call list
                (
                    ARG1
                )
            )
            (call read_files
                (
                    ARG1
                )
            )
            (call read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro read_files ((type ARG1))
            (allow ARG1 home_cache_file
                (files
                    (
                        read
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro read_lnk_files ((type ARG1))
            (allow ARG1 home_cache_file
                (lnk_files
                    (
                        read
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabel ((type ARG1))
            (call relabel_dirs
                (
                    ARG1
                )
            )
            (call relabel_files
                (
                    ARG1
                )
            )
            (call relabel_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro relabel_dirs ((type ARG1))
            (allow ARG1 home_cache_file
                (dirs
                    (
                        relabel
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabel_files ((type ARG1))
            (allow ARG1 home_cache_file
                (files
                    (
                        relabel
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabel_lnk_files ((type ARG1))
            (allow ARG1 home_cache_file
                (lnk_files
                    (
                        relabel
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom ((type ARG1))
            (call relabelfrom_dirs
                (
                    ARG1
                )
            )
            (call relabelfrom_files
                (
                    ARG1
                )
            )
            (call relabelfrom_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_dirs ((type ARG1))
            (allow ARG1 home_cache_file
                (dirs
                    (
                        relabelfrom
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_files ((type ARG1))
            (allow ARG1 home_cache_file
                (files
                    (
                        relabelfrom
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_lnk_files ((type ARG1))
            (allow ARG1 home_cache_file
                (lnk_files
                    (
                        relabelfrom
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto ((type ARG1))
            (call relabelto_dirs
                (
                    ARG1
                )
            )
            (call relabelto_files
                (
                    ARG1
                )
            )
            (call relabelto_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro relabelto_dirs ((type ARG1))
            (allow ARG1 home_cache_file
                (dirs
                    (
                        relabelto
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto_files ((type ARG1))
            (allow ARG1 home_cache_file
                (files
                    (
                        relabelto
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto_lnk_files ((type ARG1))
            (allow ARG1 home_cache_file
                (lnk_files
                    (
                        relabelto
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rename ((type ARG1))
            (call rename_dirs
                (
                    ARG1
                )
            )
            (call rename_files
                (
                    ARG1
                )
            )
            (call rename_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro rename_dirs ((type ARG1))
            (allow ARG1 home_cache_file
                (dirs
                    (
                        rename
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rename_files ((type ARG1))
            (allow ARG1 home_cache_file
                (files
                    (
                        rename
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rename_lnk_files ((type ARG1))
            (allow ARG1 home_cache_file
                (lnk_files
                    (
                        rename
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rw ((type ARG1))
            (call rw_dirs
                (
                    ARG1
                )
            )
            (call rw_files
                (
                    ARG1
                )
            )
            (call rw_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro rw_dirs ((type ARG1))
            (allow ARG1 home_cache_file
                (dirs
                    (
                        rw
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rw_files ((type ARG1))
            (allow ARG1 home_cache_file
                (files
                    (
                        rw
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rw_lnk_files ((type ARG1))
            (allow ARG1 home_cache_file
                (lnk_files
                    (
                        rw
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro search ((type ARG1))
            (allow ARG1 home_cache_file search_dir_perms)
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro setattr ((type ARG1))
            (call setattr_dirs
                (
                    ARG1
                )
            )
            (call setattr_files
                (
                    ARG1
                )
            )
            (call setattr_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro setattr_dirs ((type ARG1))
            (allow ARG1 home_cache_file
                (dirs
                    (
                        setattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro setattr_files ((type ARG1))
            (allow ARG1 home_cache_file
                (files
                    (
                        setattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro setattr_lnk_files ((type ARG1))
            (allow ARG1 home_cache_file
                (lnk_files
                    (
                        setattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro write ((type ARG1))
            (call write_dirs
                (
                    ARG1
                )
            )
            (call write_files
                (
                    ARG1
                )
            )
            (call write_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro write_dirs ((type ARG1))
            (allow ARG1 home_cache_file
                (dirs
                    (
                        write
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro write_files ((type ARG1))
            (allow ARG1 home_cache_file
                (files
                    (
                        write
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro write_lnk_files ((type ARG1))
            (allow ARG1 home_cache_file
                (lnk_files
                    (
                        write
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        ;
        ; generic_cache policy
        ;

        (blockinherit home_cache_file.obj_template)

        (typeattribute client_subj_type_attribute)

        (call create_dirs
            (
                client_subj_type_attribute
            )
        )

        (call home_dir_obj_type_transition
            (
                client_subj_type_attribute
            )
        )
    )

    ;
    ; Users generic_config name space
    ;

    (block generic_config

        ;
        ; generic_config contexts
        ;

        (filecon "HOME_DIR/\.config(/.*)?" any home_config_file_context)

        ;
        ; generic_config macros
        ;

        (macro add_entries ((type ARG1))
            (allow ARG1 home_config_file add_entry_dir_perms)
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro append_files ((type ARG1))
            (allow ARG1 home_config_file append_file_perms)
            (call search
                (
                    ARG1
                )
            )
        )

        (macro client_subj_type ((type ARG1))
            (typeattributeset client_subj_type_attribute ARG1)
        )

        (macro create ((type ARG1))
            (call create_dirs
                (
                    ARG1
                )
            )
            (call create_files
                (
                    ARG1
                )
            )
            (call create_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro create_dirs ((type ARG1))
            (allow ARG1 home_config_file
                (dirs
                    (
                        create
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro create_files ((type ARG1))
            (allow ARG1 home_config_file
                (files
                    (
                        create
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro create_lnk_files ((type ARG1))
            (allow ARG1 home_config_file
                (lnk_files
                    (
                        create
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro del_entries ((type ARG1))
            (allow ARG1 home_config_file del_entry_dir_perms)
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro delete ((type ARG1))
            (call delete_dirs
                (
                    ARG1
                )
            )
            (call delete_files
                (
                    ARG1
                )
            )
            (call delete_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro delete_dirs ((type ARG1))
            (allow ARG1 home_config_file
                (dirs
                    (
                        delete
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro delete_files ((type ARG1))
            (allow ARG1 home_config_file
                (files
                    (
                        delete
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro delete_lnk_files ((type ARG1))
            (allow ARG1 home_config_file
                (lnk_files
                    (
                        delete
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro execute ((type ARG1))
            (allow ARG1 home_config_file exec_file_perms)
            (call search
                (
                    ARG1
                )
            )
        )

        (macro getattr ((type ARG1))
            (call getattr_dirs
                (
                    ARG1
                )
            )
            (call getattr_files
                (
                    ARG1
                )
            )
            (call getattr_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro getattr_dirs ((type ARG1))
            (allow ARG1 home_config_file
                (dirs
                    (
                        getattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro getattr_files ((type ARG1))
            (allow ARG1 home_config_file
                (files
                    (
                        getattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro getattr_lnk_files ((type ARG1))
            (allow ARG1 home_config_file
                (lnk_files
                    (
                        getattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro home_dir_obj_type_transition ((type ARG1))
            (call home_dir.obj_type_transition
                (
                    ARG1 home_config_file dir ".config"
                )
            )
        )

        (macro list ((type ARG1))
            (allow ARG1 home_config_file list_dir_perms)
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro manage ((type ARG1))
            (call manage_dirs
                (
                    ARG1
                )
            )
            (call manage_files
                (
                    ARG1
                )
            )
            (call manage_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro manage_dirs ((type ARG1))
            (allow ARG1 home_config_file
                (dirs
                    (
                        manage
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro manage_files ((type ARG1))
            (allow ARG1 home_config_file
                (files
                    (
                        manage
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro manage_lnk_files ((type ARG1))
            (allow ARG1 home_config_file
                (lnk_files
                    (
                        manage
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro mmap ((type ARG1))
            (allow ARG1 home_config_file mmap_file_perms)
            (call search
                (
                    ARG1
                )
            )
        )

        (macro obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
            (typetransition ARG1 home_config_file ARG3 ARG4 ARG2)
            (call rw_dirs
                (
                    ARG1
                )
            )
        )

        (macro read ((type ARG1))
            (call list
                (
                    ARG1
                )
            )
            (call read_files
                (
                    ARG1
                )
            )
            (call read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro read_files ((type ARG1))
            (allow ARG1 home_config_file
                (files
                    (
                        read
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro read_lnk_files ((type ARG1))
            (allow ARG1 home_config_file
                (lnk_files
                    (
                        read
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabel ((type ARG1))
            (call relabel_dirs
                (
                    ARG1
                )
            )
            (call relabel_files
                (
                    ARG1
                )
            )
            (call relabel_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro relabel_dirs ((type ARG1))
            (allow ARG1 home_config_file
                (dirs
                    (
                        relabel
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabel_files ((type ARG1))
            (allow ARG1 home_config_file
                (files
                    (
                        relabel
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabel_lnk_files ((type ARG1))
            (allow ARG1 home_config_file
                (lnk_files
                    (
                        relabel
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom ((type ARG1))
            (call relabelfrom_dirs
                (
                    ARG1
                )
            )
            (call relabelfrom_files
                (
                    ARG1
                )
            )
            (call relabelfrom_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_dirs ((type ARG1))
            (allow ARG1 home_config_file
                (dirs
                    (
                        relabelfrom
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_files ((type ARG1))
            (allow ARG1 home_config_file
                (files
                    (
                        relabelfrom
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_lnk_files ((type ARG1))
            (allow ARG1 home_config_file
                (lnk_files
                    (
                        relabelfrom
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto ((type ARG1))
            (call relabelto_dirs
                (
                    ARG1
                )
            )
            (call relabelto_files
                (
                    ARG1
                )
            )
            (call relabelto_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro relabelto_dirs ((type ARG1))
            (allow ARG1 home_config_file
                (dirs
                    (
                        relabelto
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto_files ((type ARG1))
            (allow ARG1 home_config_file
                (files
                    (
                        relabelto
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto_lnk_files ((type ARG1))
            (allow ARG1 home_config_file
                (lnk_files
                    (
                        relabelto
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rename ((type ARG1))
            (call rename_dirs
                (
                    ARG1
                )
            )
            (call rename_files
                (
                    ARG1
                )
            )
            (call rename_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro rename_dirs ((type ARG1))
            (allow ARG1 home_config_file
                (dirs
                    (
                        rename
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rename_files ((type ARG1))
            (allow ARG1 home_config_file
                (files
                    (
                        rename
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rename_lnk_files ((type ARG1))
            (allow ARG1 home_config_file
                (lnk_files
                    (
                        rename
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rw ((type ARG1))
            (call rw_dirs
                (
                    ARG1
                )
            )
            (call rw_files
                (
                    ARG1
                )
            )
            (call rw_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro rw_dirs ((type ARG1))
            (allow ARG1 home_config_file
                (dirs
                    (
                        rw
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rw_files ((type ARG1))
            (allow ARG1 home_config_file
                (files
                    (
                        rw
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rw_lnk_files ((type ARG1))
            (allow ARG1 home_config_file
                (lnk_files
                    (
                        rw
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro search ((type ARG1))
            (allow ARG1 home_config_file search_dir_perms)
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro setattr ((type ARG1))
            (call setattr_dirs
                (
                    ARG1
                )
            )
            (call setattr_files
                (
                    ARG1
                )
            )
            (call setattr_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro setattr_dirs ((type ARG1))
            (allow ARG1 home_config_file
                (dirs
                    (
                        setattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro setattr_files ((type ARG1))
            (allow ARG1 home_config_file
                (files
                    (
                        setattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro setattr_lnk_files ((type ARG1))
            (allow ARG1 home_config_file
                (lnk_files
                    (
                        setattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro write ((type ARG1))
            (call write_dirs
                (
                    ARG1
                )
            )
            (call write_files
                (
                    ARG1
                )
            )
            (call write_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro write_dirs ((type ARG1))
            (allow ARG1 home_config_file
                (dirs
                    (
                        write
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro write_files ((type ARG1))
            (allow ARG1 home_config_file
                (files
                    (
                        write
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro write_lnk_files ((type ARG1))
            (allow ARG1 home_config_file
                (lnk_files
                    (
                        write
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        ;
        ; generic_config policy
        ;

        (blockinherit home_config_file.obj_template)

        (typeattribute client_subj_type_attribute)

        (call create_dirs
            (
                client_subj_type_attribute
            )
        )

        (call home_dir_obj_type_transition
            (
                client_subj_type_attribute
            )
        )
    )

    ;
    ; Users generic_data name space
    ;

    (block generic_data

        ;
        ; generic_data contexts
        ;

        (filecon "HOME_DIR/\.local(/.*)?" any home_data_file_context)

        ;
        ; generic_data macros
        ;

        (macro add_entries ((type ARG1))
            (allow ARG1 home_data_file add_entry_dir_perms)
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro append_files ((type ARG1))
            (allow ARG1 home_data_file append_file_perms)
            (call search
                (
                    ARG1
                )
            )
        )

        (macro client_subj_type ((type ARG1))
            (typeattributeset client_subj_type_attribute ARG1)
        )

        (macro create ((type ARG1))
            (call create_dirs
                (
                    ARG1
                )
            )
            (call create_files
                (
                    ARG1
                )
            )
            (call create_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro create_dirs ((type ARG1))
            (allow ARG1 home_data_file
                (dirs
                    (
                        create
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro create_files ((type ARG1))
            (allow ARG1 home_data_file
                (files
                    (
                        create
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro create_lnk_files ((type ARG1))
            (allow ARG1 home_data_file
                (lnk_files
                    (
                        create
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro del_entries ((type ARG1))
            (allow ARG1 home_data_file del_entry_dir_perms)
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro delete ((type ARG1))
            (call delete_dirs
                (
                    ARG1
                )
            )
            (call delete_files
                (
                    ARG1
                )
            )
            (call delete_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro delete_dirs ((type ARG1))
            (allow ARG1 home_data_file
                (dirs
                    (
                        delete
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro delete_files ((type ARG1))
            (allow ARG1 home_data_file
                (files
                    (
                        delete
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro delete_lnk_files ((type ARG1))
            (allow ARG1 home_data_file
                (lnk_files
                    (
                        delete
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro execute ((type ARG1))
            (allow ARG1 home_data_file exec_file_perms)
            (call search
                (
                    ARG1
                )
            )
        )

        (macro getattr ((type ARG1))
            (call getattr_dirs
                (
                    ARG1
                )
            )
            (call getattr_files
                (
                    ARG1
                )
            )
            (call getattr_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro getattr_dirs ((type ARG1))
            (allow ARG1 home_data_file
                (dirs
                    (
                        getattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro getattr_files ((type ARG1))
            (allow ARG1 home_data_file
                (files
                    (
                        getattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro getattr_lnk_files ((type ARG1))
            (allow ARG1 home_data_file
                (lnk_files
                    (
                        getattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro home_dir_obj_type_transition ((type ARG1))
            (call home_dir.obj_type_transition
                (
                    ARG1 home_data_file dir ".local"
                )
            )
        )

        (macro list ((type ARG1))
            (allow ARG1 home_data_file list_dir_perms)
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro manage ((type ARG1))
            (call manage_dirs
                (
                    ARG1
                )
            )
            (call manage_files
                (
                    ARG1
                )
            )
            (call manage_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro manage_dirs ((type ARG1))
            (allow ARG1 home_data_file
                (dirs
                    (
                        manage
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro manage_files ((type ARG1))
            (allow ARG1 home_data_file
                (files
                    (
                        manage
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro manage_lnk_files ((type ARG1))
            (allow ARG1 home_data_file
                (lnk_files
                    (
                        manage
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro mmap ((type ARG1))
            (allow ARG1 home_data_file mmap_file_perms)
            (call search
                (
                    ARG1
                )
            )
        )

        (macro obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
            (typetransition ARG1 home_data_file ARG3 ARG4 ARG2)
            (call rw_dirs
                (
                    ARG1
                )
            )
        )

        (macro read ((type ARG1))
            (call list
                (
                    ARG1
                )
            )
            (call read_files
                (
                    ARG1
                )
            )
            (call read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro read_files ((type ARG1))
            (allow ARG1 home_data_file
                (files
                    (
                        read
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro read_lnk_files ((type ARG1))
            (allow ARG1 home_data_file
                (lnk_files
                    (
                        read
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabel ((type ARG1))
            (call relabel_dirs
                (
                    ARG1
                )
            )
            (call relabel_files
                (
                    ARG1
                )
            )
            (call relabel_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro relabel_dirs ((type ARG1))
            (allow ARG1 home_data_file
                (dirs
                    (
                        relabel
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabel_files ((type ARG1))
            (allow ARG1 home_data_file
                (files
                    (
                        relabel
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabel_lnk_files ((type ARG1))
            (allow ARG1 home_data_file
                (lnk_files
                    (
                        relabel
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom ((type ARG1))
            (call relabelfrom_dirs
                (
                    ARG1
                )
            )
            (call relabelfrom_files
                (
                    ARG1
                )
            )
            (call relabelfrom_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_dirs ((type ARG1))
            (allow ARG1 home_data_file
                (dirs
                    (
                        relabelfrom
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_files ((type ARG1))
            (allow ARG1 home_data_file
                (files
                    (
                        relabelfrom
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_lnk_files ((type ARG1))
            (allow ARG1 home_data_file
                (lnk_files
                    (
                        relabelfrom
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto ((type ARG1))
            (call relabelto_dirs
                (
                    ARG1
                )
            )
            (call relabelto_files
                (
                    ARG1
                )
            )
            (call relabelto_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro relabelto_dirs ((type ARG1))
            (allow ARG1 home_data_file
                (dirs
                    (
                        relabelto
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto_files ((type ARG1))
            (allow ARG1 home_data_file
                (files
                    (
                        relabelto
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto_lnk_files ((type ARG1))
            (allow ARG1 home_data_file
                (lnk_files
                    (
                        relabelto
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rename ((type ARG1))
            (call rename_dirs
                (
                    ARG1
                )
            )
            (call rename_files
                (
                    ARG1
                )
            )
            (call rename_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro rename_dirs ((type ARG1))
            (allow ARG1 home_data_file
                (dirs
                    (
                        rename
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rename_files ((type ARG1))
            (allow ARG1 home_data_file
                (files
                    (
                        rename
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rename_lnk_files ((type ARG1))
            (allow ARG1 home_data_file
                (lnk_files
                    (
                        rename
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rw ((type ARG1))
            (call rw_dirs
                (
                    ARG1
                )
            )
            (call rw_files
                (
                    ARG1
                )
            )
            (call rw_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro rw_dirs ((type ARG1))
            (allow ARG1 home_data_file
                (dirs
                    (
                        rw
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rw_files ((type ARG1))
            (allow ARG1 home_data_file
                (files
                    (
                        rw
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rw_lnk_files ((type ARG1))
            (allow ARG1 home_data_file
                (lnk_files
                    (
                        rw
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro search ((type ARG1))
            (allow ARG1 home_data_file search_dir_perms)
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro setattr ((type ARG1))
            (call setattr_dirs
                (
                    ARG1
                )
            )
            (call setattr_files
                (
                    ARG1
                )
            )
            (call setattr_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro setattr_dirs ((type ARG1))
            (allow ARG1 home_data_file
                (dirs
                    (
                        setattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro setattr_files ((type ARG1))
            (allow ARG1 home_data_file
                (files
                    (
                        setattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro setattr_lnk_files ((type ARG1))
            (allow ARG1 home_data_file
                (lnk_files
                    (
                        setattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro write ((type ARG1))
            (call write_dirs
                (
                    ARG1
                )
            )
            (call write_files
                (
                    ARG1
                )
            )
            (call write_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro write_dirs ((type ARG1))
            (allow ARG1 home_data_file
                (dirs
                    (
                        write
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro write_files ((type ARG1))
            (allow ARG1 home_data_file
                (files
                    (
                        write
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro write_lnk_files ((type ARG1))
            (allow ARG1 home_data_file
                (lnk_files
                    (
                        write
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        ;
        ; generic_data policy
        ;

        (blockinherit home_data_file.obj_template)

        (typeattribute client_subj_type_attribute)

        (call create_dirs
            (
                client_subj_type_attribute
            )
        )

        (call home_dir_obj_type_transition
            (
                client_subj_type_attribute
            )
        )
    )

    ;
    ; Users generic_home name space
    ;

    (block generic_home

        ;
        ; generic_home contexts
        ;

        (filecon "HOME_DIR/.*" any home_file_context)

        ;
        ; generic_home macros
        ;

        (macro add_entries ((type ARG1))
            (allow ARG1 home_file add_entry_dir_perms)
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro append_fifo_files ((type ARG1))
            (allow ARG1 home_file append_fifo_file_perms)
            (call search
                (
                    ARG1
                )
            )
        )

        (macro append_files ((type ARG1))
            (allow ARG1 home_file append_file_perms)
            (call search
                (
                    ARG1
                )
            )
        )

        (macro create ((type ARG1))
            (allow ARG1 home_file
                (files_except_blk_and_chr
                    (
                        create
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro create_dirs ((type ARG1))
            (allow ARG1 home_file
                (dirs
                    (
                        create
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro create_fifo_files ((type ARG1))
            (allow ARG1 home_file
                (fifo_files
                    (
                        create
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro create_files ((type ARG1))
            (allow ARG1 home_file
                (files
                    (
                        create
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro create_lnk_files ((type ARG1))
            (allow ARG1 home_file
                (lnk_files
                    (
                        create
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro create_sock_files ((type ARG1))
            (allow ARG1 home_file
                (sock_files
                    (
                        create
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro del_entries ((type ARG1))
            (allow ARG1 home_file_file del_entry_dir_perms)
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro delete ((type ARG1))
            (allow ARG1 home_file
                (files_except_blk_and_chr
                    (
                        delete
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro delete_dirs ((type ARG1))
            (allow ARG1 home_file
                (dirs
                    (
                        delete
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro delete_fifo_files ((type ARG1))
            (allow ARG1 home_file
                (fifo_files
                    (
                        delete
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro delete_files ((type ARG1))
            (allow ARG1 home_file
                (files
                    (
                        delete
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro delete_lnk_files ((type ARG1))
            (allow ARG1 home_file
                (lnk_files
                    (
                        delete
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro delete_sock_files ((type ARG1))
            (allow ARG1 home_file
                (sock_files
                    (
                        delete
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro execute ((type ARG1))
            (allow ARG1 home_file exec_file_perms)
            (call search
                (
                    ARG1
                )
            )
        )

        (macro getattr ((type ARG1))
            (allow ARG1 home_file
                (files_except_blk_and_chr
                    (
                        getattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro getattr_dirs ((type ARG1))
            (allow ARG1 home_file
                (dirs
                    (
                        getattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro getattr_fifo_files ((type ARG1))
            (allow ARG1 home_file
                (fifo_files
                    (
                        getattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro getattr_files ((type ARG1))
            (allow ARG1 home_file
                (files
                    (
                        getattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro getattr_lnk_files ((type ARG1))
            (allow ARG1 home_file
                (lnk_files
                    (
                        getattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro getattr_sock_files ((type ARG1))
            (allow ARG1 home_file
                (sock_files
                    (
                        getattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro home_dir_obj_type_transition ((type ARG1)(class ARG2)(name ARG3))
            (call home_dir.obj_type_transition
                (
                    ARG1 home_file ARG2 ARG3
                )
            )
        )

        (macro list ((type ARG1))
            (allow ARG1 home_file list_dir_perms)
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro manage ((type ARG1))
            (allow ARG1 home_file
                (files_except_blk_and_chr
                    (
                        manage
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro manage_dirs ((type ARG1))
            (allow ARG1 home_file
                (dirs
                    (
                        manage
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro manage_fifo_files ((type ARG1))
            (allow ARG1 home_file
                (fifo_files
                    (
                        manage
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro manage_files ((type ARG1))
            (allow ARG1 home_file
                (files
                    (
                        manage
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro manage_lnk_files ((type ARG1))
            (allow ARG1 home_file
                (lnk_files
                    (
                        manage
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro manage_sock_files ((type ARG1))
            (allow ARG1 home_file
                (sock_files
                    (
                        manage
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro mmap ((type ARG1))
            (allow ARG1 home_file mmap_file_perms)
            (call search
                (
                    ARG1
                )
            )
        )

        (macro obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
            (typetransition ARG1 home_file ARG3 ARG4 ARG2)
            (call rw_dirs
                (
                    ARG1
                )
            )
        )

        (macro read ((type ARG1))
            (allow ARG1 home_file
                (files_except_blk_and_chr
                    (
                        read
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro read_fifo_files ((type ARG1))
            (allow ARG1 home_file
                (fifo_files
                    (
                        read
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro read_files ((type ARG1))
            (allow ARG1 home_file
                (files
                    (
                        read
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro read_lnk_files ((type ARG1))
            (allow ARG1 home_file
                (lnk_files
                    (
                        read
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro read_sock_files ((type ARG1))
            (allow ARG1 home_file
                (sock_files
                    (
                        read
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabel ((type ARG1))
            (allow ARG1 home_file
                (files_except_blk_and_chr
                    (
                        relabel
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabel_dirs ((type ARG1))
            (allow ARG1 home_file
                (dirs
                    (
                        relabel
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabel_fifo_files ((type ARG1))
            (allow ARG1 home_file
                (fifo_files
                    (
                        relabel
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabel_files ((type ARG1))
            (allow ARG1 home_file
                (files
                    (
                        relabel
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabel_lnk_files ((type ARG1))
            (allow ARG1 home_file
                (lnk_files
                    (
                        relabel
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabel_sock_files ((type ARG1))
            (allow ARG1 home_file
                (sock_files
                    (
                        relabel
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom ((type ARG1))
            (allow ARG1 home_file
                (files_except_blk_and_chr
                    (
                        relabelfrom
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_dirs ((type ARG1))
            (allow ARG1 home_file
                (dirs
                    (
                        relabelfrom
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_fifo_files ((type ARG1))
            (allow ARG1 home_file
                (fifo_files
                    (
                        relabelfrom
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_files ((type ARG1))
            (allow ARG1 home_file
                (files
                    (
                        relabelfrom
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_lnk_files ((type ARG1))
            (allow ARG1 home_file
                (lnk_files
                    (
                        relabelfrom
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_sock_files ((type ARG1))
            (allow ARG1 home_file
                (sock_files
                    (
                        relabelfrom
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto ((type ARG1))
            (allow ARG1 home_file
                (files_except_blk_and_chr
                    (
                        relabelto
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto_dirs ((type ARG1))
            (allow ARG1 home_file
                (dirs
                    (
                        relabelto
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto_fifo_files ((type ARG1))
            (allow ARG1 home_file
                (fifo_files
                    (
                        relabelto
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto_files ((type ARG1))
            (allow ARG1 home_file
                (files
                    (
                        relabelto
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto_lnk_files ((type ARG1))
            (allow ARG1 home_file
                (lnk_files
                    (
                        relabelto
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto_sock_files ((type ARG1))
            (allow ARG1 home_file
                (sock_files
                    (
                        relabelto
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rename ((type ARG1))
            (allow ARG1 home_file
                (files_except_blk_and_chr
                    (
                        rename
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rename_dirs ((type ARG1))
            (allow ARG1 home_file
                (dirs
                    (
                        rename
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rename_fifo_files ((type ARG1))
            (allow ARG1 home_file
                (fifo_files
                    (
                        rename
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rename_files ((type ARG1))
            (allow ARG1 home_file
                (files
                    (
                        rename
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rename_lnk_files ((type ARG1))
            (allow ARG1 home_file
                (lnk_files
                    (
                        rename
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rename_sock_files ((type ARG1))
            (allow ARG1 home_file
                (sock_files
                    (
                        rename
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rw ((type ARG1))
            (allow ARG1 home_file
                (files_except_blk_and_chr
                    (
                        rw
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rw_dirs ((type ARG1))
            (allow ARG1 home_file
                (dirs
                    (
                        rw
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rw_fifo_files ((type ARG1))
            (allow ARG1 home_file
                (fifo_files
                    (
                        rw
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rw_files ((type ARG1))
            (allow ARG1 home_file
                (files
                    (
                        rw
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rw_lnk_files ((type ARG1))
            (allow ARG1 home_file
                (lnk_files
                    (
                        rw
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro rw_sock_files ((type ARG1))
            (allow ARG1 home_file
                (sock_files
                    (
                        rw
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro search ((type ARG1))
            (allow ARG1 home_file search_dir_perms)
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro setattr ((type ARG1))
            (allow ARG1 home_file
                (files_except_blk_and_chr
                    (
                        setattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro setattr_dirs ((type ARG1))
            (allow ARG1 home_file
                (dirs
                    (
                        setattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro setattr_fifo_files ((type ARG1))
            (allow ARG1 home_file
                (fifo_files
                    (
                        setattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro setattr_files ((type ARG1))
            (allow ARG1 home_file
                (files
                    (
                        setattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro setattr_lnk_files ((type ARG1))
            (allow ARG1 home_file
                (lnk_files
                    (
                        setattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro setattr_sock_files ((type ARG1))
            (allow ARG1 home_file
                (sock_files
                    (
                        setattr
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro write ((type ARG1))
            (allow ARG1 home_file
                (files_except_blk_and_chr
                    (
                        write
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro write_dirs ((type ARG1))
            (allow ARG1 home_file
                (dirs
                    (
                        write
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro write_fifo_files ((type ARG1))
            (allow ARG1 home_file
                (fifo_files
                    (
                        write
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro write_files ((type ARG1))
            (allow ARG1 home_file
                (files
                    (
                        write
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro write_lnk_files ((type ARG1))
            (allow ARG1 home_file
                (lnk_files
                    (
                        write
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        (macro write_sock_files ((type ARG1))
            (allow ARG1 home_file
                (sock_files
                    (
                        write
                    )
                )
            )
            (call home_dir.search
                (
                    ARG1
                )
            )
        )

        ;
        ; generic_home policy
        ;

        (blockinherit home_file.obj_template)
    )

    ;
    ; Users generic_tmp name space
    ;

    (block generic_tmp

        ;
        ; generic_tmp macros
        ;

        (macro add_entries ((type ARG1))
            (allow ARG1 user_tmp_file add_entry_dir_perms)
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro append_fifo_files ((type ARG1))
            (allow ARG1 user_tmp_file append_fifo_file_perms)
            (call search
                (
                    ARG1
                )
            )
        )

        (macro append_files ((type ARG1))
            (allow ARG1 user_tmp_file append_file_perms)
            (call search
                (
                    ARG1
                )
            )
        )

        (macro create ((type ARG1))
            (allow ARG1 user_tmp_file
                (files_except_blk_and_chr
                    (
                        create
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro create_dirs ((type ARG1))
            (allow ARG1 user_tmp_file
                (dirs
                    (
                        create
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro create_fifo_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (fifo_files
                    (
                        create
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro create_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (files
                    (
                        create
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro create_lnk_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (lnk_files
                    (
                        create
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro create_sock_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (sock_files
                    (
                        create
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro del_entries ((type ARG1))
            (allow ARG1 user_tmp_file_file del_entry_dir_perms)
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro delete ((type ARG1))
            (allow ARG1 user_tmp_file
                (files_except_blk_and_chr
                    (
                        delete
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro delete_dirs ((type ARG1))
            (allow ARG1 user_tmp_file
                (dirs
                    (
                        delete
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro delete_fifo_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (fifo_files
                    (
                        delete
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro delete_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (files
                    (
                        delete
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro delete_lnk_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (lnk_files
                    (
                        delete
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro delete_sock_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (sock_files
                    (
                        delete
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro execute ((type ARG1))
            (allow ARG1 user_tmp_file exec_file_perms)
            (call search
                (
                    ARG1
                )
            )
        )

        (macro generic_var_tmp_obj_type_transition ((type ARG1)(class ARG2)(name ARG3))
            (call files.generic_var_tmp.obj_type_transition
                (
                    ARG1 user_tmp_file ARG2 ARG3
                )
            )
        )

        (macro getattr ((type ARG1))
            (allow ARG1 user_tmp_file
                (files_except_blk_and_chr
                    (
                        getattr
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro getattr_dirs ((type ARG1))
            (allow ARG1 user_tmp_file
                (dirs
                    (
                        getattr
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro getattr_fifo_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (fifo_files
                    (
                        getattr
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro getattr_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (files
                    (
                        getattr
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro getattr_lnk_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (lnk_files
                    (
                        getattr
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro getattr_sock_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (sock_files
                    (
                        getattr
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro list ((type ARG1))
            (allow ARG1 user_tmp_file list_dir_perms)
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro manage ((type ARG1))
            (allow ARG1 user_tmp_file
                (files_except_blk_and_chr
                    (
                        manage
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro manage_dirs ((type ARG1))
            (allow ARG1 user_tmp_file
                (dirs
                    (
                        manage
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro manage_fifo_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (fifo_files
                    (
                        manage
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro manage_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (files
                    (
                        manage
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro manage_lnk_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (lnk_files
                    (
                        manage
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro manage_sock_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (sock_files
                    (
                        manage
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro mmap ((type ARG1))
            (allow ARG1 user_tmp_file mmap_file_perms)
            (call search
                (
                    ARG1
                )
            )
        )

        (macro obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
            (typetransition ARG1 user_tmp_file ARG3 ARG4 ARG2)
            (call rw_dirs
                (
                    ARG1
                )
            )
        )

        (macro read ((type ARG1))
            (allow ARG1 user_tmp_file
                (files_except_blk_and_chr
                    (
                        read
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro read_fifo_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (fifo_files
                    (
                        read
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro read_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (files
                    (
                        read
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro read_lnk_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (lnk_files
                    (
                        read
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro read_sock_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (sock_files
                    (
                        read
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro relabel ((type ARG1))
            (allow ARG1 user_tmp_file
                (files_except_blk_and_chr
                    (
                        relabel
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro relabel_dirs ((type ARG1))
            (allow ARG1 user_tmp_file
                (dirs
                    (
                        relabel
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro relabel_fifo_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (fifo_files
                    (
                        relabel
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro relabel_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (files
                    (
                        relabel
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro relabel_lnk_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (lnk_files
                    (
                        relabel
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro relabel_sock_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (sock_files
                    (
                        relabel
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom ((type ARG1))
            (allow ARG1 user_tmp_file
                (files_except_blk_and_chr
                    (
                        relabelfrom
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_dirs ((type ARG1))
            (allow ARG1 user_tmp_file
                (dirs
                    (
                        relabelfrom
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_fifo_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (fifo_files
                    (
                        relabelfrom
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (files
                    (
                        relabelfrom
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_lnk_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (lnk_files
                    (
                        relabelfrom
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_sock_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (sock_files
                    (
                        relabelfrom
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto ((type ARG1))
            (allow ARG1 user_tmp_file
                (files_except_blk_and_chr
                    (
                        relabelto
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto_dirs ((type ARG1))
            (allow ARG1 user_tmp_file
                (dirs
                    (
                        relabelto
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto_fifo_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (fifo_files
                    (
                        relabelto
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (files
                    (
                        relabelto
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto_lnk_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (lnk_files
                    (
                        relabelto
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto_sock_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (sock_files
                    (
                        relabelto
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro rename ((type ARG1))
            (allow ARG1 user_tmp_file
                (files_except_blk_and_chr
                    (
                        rename
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro rename_dirs ((type ARG1))
            (allow ARG1 user_tmp_file
                (dirs
                    (
                        rename
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro rename_fifo_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (fifo_files
                    (
                        rename
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro rename_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (files
                    (
                        rename
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro rename_lnk_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (lnk_files
                    (
                        rename
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro rename_sock_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (sock_files
                    (
                        rename
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro rw ((type ARG1))
            (allow ARG1 user_tmp_file
                (files_except_blk_and_chr
                    (
                        rw
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro rw_dirs ((type ARG1))
            (allow ARG1 user_tmp_file
                (dirs
                    (
                        rw
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro rw_fifo_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (fifo_files
                    (
                        rw
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro rw_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (files
                    (
                        rw
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro rw_lnk_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (lnk_files
                    (
                        rw
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro rw_sock_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (sock_files
                    (
                        rw
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro search ((type ARG1))
            (allow ARG1 user_tmp_file search_dir_perms)
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro setattr ((type ARG1))
            (allow ARG1 user_tmp_file
                (files_except_blk_and_chr
                    (
                        setattr
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro setattr_dirs ((type ARG1))
            (allow ARG1 user_tmp_file
                (dirs
                    (
                        setattr
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro setattr_fifo_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (fifo_files
                    (
                        setattr
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro setattr_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (files
                    (
                        setattr
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro setattr_lnk_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (lnk_files
                    (
                        setattr
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro setattr_sock_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (sock_files
                    (
                        setattr
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro write ((type ARG1))
            (allow ARG1 user_tmp_file
                (files_except_blk_and_chr
                    (
                        write
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro write_dirs ((type ARG1))
            (allow ARG1 user_tmp_file
                (dirs
                    (
                        write
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro write_fifo_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (fifo_files
                    (
                        write
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro write_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (files
                    (
                        write
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro write_lnk_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (lnk_files
                    (
                        write
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        (macro write_sock_files ((type ARG1))
            (allow ARG1 user_tmp_file
                (sock_files
                    (
                        write
                    )
                )
            )
            (call files.generic_var_tmp.search
                (
                    ARG1
                )
            )
        )

        ;
        ; generic_tmp policy
        ;

        (blockinherit user_tmp_file.obj_stub)
    )

    ;
    ; Users generic_tmpfs name space
    ;

    (block generic_tmpfs

        ;
        ; generic_tmpfs macros
        ;

        (macro add_entries ((type ARG1))
            (allow ARG1 user_tmpfs_file add_entry_dir_perms)
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro append_fifo_files ((type ARG1))
            (allow ARG1 user_tmpfs_file append_fifo_file_perms)
            (call search
                (
                    ARG1
                )
            )
        )

        (macro append_files ((type ARG1))
            (allow ARG1 user_tmpfs_file append_file_perms)
            (call search
                (
                    ARG1
                )
            )
        )

        (macro create ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (files_except_blk_and_chr
                    (
                        create
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro create_dirs ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (dirs
                    (
                        create
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro create_fifo_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (fifo_files
                    (
                        create
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro create_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (files
                    (
                        create
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro create_lnk_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (lnk_files
                    (
                        create
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro create_sock_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (sock_files
                    (
                        create
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro del_entries ((type ARG1))
            (allow ARG1 user_tmpfs_file_file del_entry_dir_perms)
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro delete ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (files_except_blk_and_chr
                    (
                        delete
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro delete_dirs ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (dirs
                    (
                        delete
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro delete_fifo_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (fifo_files
                    (
                        delete
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro delete_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (files
                    (
                        delete
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro delete_lnk_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (lnk_files
                    (
                        delete
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro delete_sock_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (sock_files
                    (
                        delete
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro execute ((type ARG1))
            (allow ARG1 user_tmpfs_file exec_file_perms)
            (call search
                (
                    ARG1
                )
            )
        )

        (macro getattr ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (files_except_blk_and_chr
                    (
                        getattr
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro getattr_dirs ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (dirs
                    (
                        getattr
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro getattr_fifo_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (fifo_files
                    (
                        getattr
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro getattr_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (files
                    (
                        getattr
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro getattr_lnk_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (lnk_files
                    (
                        getattr
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro getattr_sock_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (sock_files
                    (
                        getattr
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro list ((type ARG1))
            (allow ARG1 user_tmpfs_file list_dir_perms)
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro manage ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (files_except_blk_and_chr
                    (
                        manage
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro manage_dirs ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (dirs
                    (
                        manage
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro manage_fifo_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (fifo_files
                    (
                        manage
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro manage_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (files
                    (
                        manage
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro manage_lnk_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (lnk_files
                    (
                        manage
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro manage_sock_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (sock_files
                    (
                        manage
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro mmap ((type ARG1))
            (allow ARG1 user_tmpfs_file mmap_file_perms)
            (call search
                (
                    ARG1
                )
            )
        )

        (macro obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
            (typetransition ARG1 user_tmpfs_file ARG3 ARG4 ARG2)
            (call rw_dirs
                (
                    ARG1
                )
            )
        )

        (macro read ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (files_except_blk_and_chr
                    (
                        read
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro read_fifo_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (fifo_files
                    (
                        read
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro read_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (files
                    (
                        read
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro read_lnk_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (lnk_files
                    (
                        read
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro read_sock_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (sock_files
                    (
                        read
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro relabel ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (files_except_blk_and_chr
                    (
                        relabel
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro relabel_dirs ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (dirs
                    (
                        relabel
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro relabel_fifo_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (fifo_files
                    (
                        relabel
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro relabel_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (files
                    (
                        relabel
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro relabel_lnk_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (lnk_files
                    (
                        relabel
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro relabel_sock_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (sock_files
                    (
                        relabel
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (files_except_blk_and_chr
                    (
                        relabelfrom
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_dirs ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (dirs
                    (
                        relabelfrom
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_fifo_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (fifo_files
                    (
                        relabelfrom
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (files
                    (
                        relabelfrom
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_lnk_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (lnk_files
                    (
                        relabelfrom
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_sock_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (sock_files
                    (
                        relabelfrom
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (files_except_blk_and_chr
                    (
                        relabelto
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto_dirs ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (dirs
                    (
                        relabelto
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto_fifo_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (fifo_files
                    (
                        relabelto
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (files
                    (
                        relabelto
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto_lnk_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (lnk_files
                    (
                        relabelto
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto_sock_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (sock_files
                    (
                        relabelto
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro rename ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (files_except_blk_and_chr
                    (
                        rename
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro rename_dirs ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (dirs
                    (
                        rename
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro rename_fifo_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (fifo_files
                    (
                        rename
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro rename_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (files
                    (
                        rename
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro rename_lnk_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (lnk_files
                    (
                        rename
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro rename_sock_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (sock_files
                    (
                        rename
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro rw ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (files_except_blk_and_chr
                    (
                        rw
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro rw_dirs ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (dirs
                    (
                        rw
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro rw_fifo_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (fifo_files
                    (
                        rw
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro rw_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (files
                    (
                        rw
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro rw_lnk_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (lnk_files
                    (
                        rw
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro rw_sock_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (sock_files
                    (
                        rw
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro search ((type ARG1))
            (allow ARG1 user_tmpfs_file search_dir_perms)
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro setattr ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (files_except_blk_and_chr
                    (
                        setattr
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro setattr_dirs ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (dirs
                    (
                        setattr
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro setattr_fifo_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (fifo_files
                    (
                        setattr
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro setattr_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (files
                    (
                        setattr
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro setattr_lnk_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (lnk_files
                    (
                        setattr
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro setattr_sock_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (sock_files
                    (
                        setattr
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro tmpfs_obj_type_transition ((type ARG1)(class ARG2)(name ARG3))
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.obj_type_transition
                (
                    ARG1 user_tmpfs_file ARG2 ARG3
                )
            )
        )

        (macro write ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (files_except_blk_and_chr
                    (
                        write
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro write_dirs ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (dirs
                    (
                        write
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro write_fifo_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (fifo_files
                    (
                        write
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro write_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (files
                    (
                        write
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro write_lnk_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (lnk_files
                    (
                        write
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        (macro write_sock_files ((type ARG1))
            (allow ARG1 user_tmpfs_file
                (sock_files
                    (
                        write
                    )
                )
            )
            (call files.runtime_user.search
                (
                    ARG1
                )
            )
            (call fs.tmpfs.search
                (
                    ARG1
                )
            )
        )

        ;
        ; generic_tmpfs policy
        ;

        (blockinherit user_tmpfs_file.obj_stub)
    )

    ;
    ; Users home_cache_file name space
    ;

    (block home_cache_file

        ;
        ; home_cache_file macros
        ;

        (blockinherit obj_macro_template)

        ;
        ; home_cache_file policy
        ;

        (typeattribute obj_type_attribute)

        (call home_file.obj_type
            (
                obj_type_attribute
            )
        )

        ;
        ; home_cache_file templates
        ;

        (block obj_macro_template

            ;
            ; users.home_cache_file.obj_macro_template macros
            ;

            (macro add_entries ((type ARG1))
                (allow ARG1 obj_type_attribute add_entry_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro append_files ((type ARG1))
                (allow ARG1 obj_type_attribute append_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro create ((type ARG1))
                (call create_dirs
                    (
                        ARG1
                    )
                )
                (call create_files
                    (
                        ARG1
                    )
                )
                (call create_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro create_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute create_dir_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_files ((type ARG1))
                (allow ARG1 obj_type_attribute create_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute create_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro del_entries ((type ARG1))
                (allow ARG1 obj_type_attribute del_entry_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete ((type ARG1))
                (call delete_dirs
                    (
                        ARG1
                    )
                )
                (call delete_files
                    (
                        ARG1
                    )
                )
                (call delete_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro delete_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute delete_dir_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_files ((type ARG1))
                (allow ARG1 obj_type_attribute delete_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute delete_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro execute ((type ARG1))
                (allow ARG1 obj_type_attribute exec_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr ((type ARG1))
                (call getattr_dirs
                    (
                        ARG1
                    )
                )
                (call getattr_files
                    (
                        ARG1
                    )
                )
                (call getattr_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (dir
                        (
                            getattr
                        )
                    )
                )
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (file
                        (
                            getattr
                        )
                    )
                )
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (lnk_file
                        (
                            getattr
                        )
                    )
                )
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro list ((type ARG1))
                (allow ARG1 obj_type_attribute list_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage ((type ARG1))
                (call manage_dirs
                    (
                        ARG1
                    )
                )
                (call manage_files
                    (
                        ARG1
                    )
                )
                (call manage_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro manage_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute manage_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_files ((type ARG1))
                (allow ARG1 obj_type_attribute manage_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute manage_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro mmap ((type ARG1))
                (allow ARG1 obj_type_attribute mmap_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro obj_type ((type ARG1))
                (typeattributeset obj_type_attribute ARG1)
            )

            (macro read ((type ARG1))
                (call list
                    (
                        ARG1
                    )
                )
                (call read_files
                    (
                        ARG1
                    )
                )
                (call read_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro read_files ((type ARG1))
                (allow ARG1 obj_type_attribute read_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute read_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel ((type ARG1))
                (call relabel_dirs
                    (
                        ARG1
                    )
                )
                (call relabel_files
                    (
                        ARG1
                    )
                )
                (call relabel_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_dir_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom ((type ARG1))
                (call relabelfrom_dirs
                    (
                        ARG1
                    )
                )
                (call relabelfrom_files
                    (
                        ARG1
                    )
                )
                (call relabelfrom_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_dir_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto ((type ARG1))
                (call relabelto_dirs
                    (
                        ARG1
                    )
                )
                (call relabelto_files
                    (
                        ARG1
                    )
                )
                (call relabelto_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_dir_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename ((type ARG1))
                (call rename_dirs
                    (
                        ARG1
                    )
                )
                (call rename_files
                    (
                        ARG1
                    )
                )
                (call rename_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro rename_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute rename_dir_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_files ((type ARG1))
                (allow ARG1 obj_type_attribute rename_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute rename_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw ((type ARG1))
                (call rw_dirs
                    (
                        ARG1
                    )
                )
                (call rw_files
                    (
                        ARG1
                    )
                )
                (call rw_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro rw_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute rw_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_files ((type ARG1))
                (allow ARG1 obj_type_attribute rw_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute rw_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro search ((type ARG1))
                (allow ARG1 obj_type_attribute search_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr ((type ARG1))
                (call setattr_dirs
                    (
                        ARG1
                    )
                )
                (call setattr_files
                    (
                        ARG1
                    )
                )
                (call setattr_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (dir
                        (
                            setattr
                        )
                    )
                )
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (file
                        (
                            setattr
                        )
                    )
                )
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (lnk_file
                        (
                            setattr
                        )
                    )
                )
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro write ((type ARG1))
                (call write_dirs
                    (
                        ARG1
                    )
                )
                (call write_files
                    (
                        ARG1
                    )
                )
                (call write_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro write_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute write_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_files ((type ARG1))
                (allow ARG1 obj_type_attribute write_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute write_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            ;
            ; users.home_cache_file.obj_macro_template policy
            ;

            (blockabstract obj_macro_template)
        )

        (block obj_stub

            ;
            ; users.home_cache_file.obj_stub contexts
            ;

            (context home_cache_file_context
                (
                    sys.id
                    sys.role
                    home_cache_file
                        (
                            systemlow
                            systemlow
                        )
                )
            )

            ;
            ; users.home_cache_file.obj_stub policy
            ;

            (blockabstract obj_stub)

            (type home_cache_file)
            (call users.home_cache_file.obj_type
                (
                    home_cache_file
                )
            )
        )

        (block obj_template

            ;
            ; users.home_cache_file.obj_template macros
            ;

            (macro add_entries ((type ARG1))
                (allow ARG1 home_cache_file add_entry_dir_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro append_files ((type ARG1))
                (allow ARG1 home_cache_file append_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro create ((type ARG1))
                (call create_dirs
                    (
                        ARG1
                    )
                )
                (call create_files
                    (
                        ARG1
                    )
                )
                (call create_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro create_dirs ((type ARG1))
                (allow ARG1 home_cache_file create_dir_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_files ((type ARG1))
                (allow ARG1 home_cache_file create_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_lnk_files ((type ARG1))
                (allow ARG1 home_cache_file create_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro del_entries ((type ARG1))
                (allow ARG1 home_cache_file del_entry_dir_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete ((type ARG1))
                (call delete_dirs
                    (
                        ARG1
                    )
                )
                (call delete_files
                    (
                        ARG1
                    )
                )
                (call delete_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro delete_dirs ((type ARG1))
                (allow ARG1 home_cache_file delete_dir_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_files ((type ARG1))
                (allow ARG1 home_cache_file delete_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_lnk_files ((type ARG1))
                (allow ARG1 home_cache_file delete_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro execute ((type ARG1))
                (allow ARG1 home_cache_file exec_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr ((type ARG1))
                (call getattr_dirs
                    (
                        ARG1
                    )
                )
                (call getattr_files
                    (
                        ARG1
                    )
                )
                (call getattr_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_dirs ((type ARG1))
                (allow ARG1 home_cache_file
                    (dir
                        (
                            getattr
                        )
                    )
                )
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_files ((type ARG1))
                (allow ARG1 home_cache_file
                    (file
                        (
                            getattr
                        )
                    )
                )
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_lnk_files ((type ARG1))
                (allow ARG1 home_cache_file
                    (lnk_file
                        (
                            getattr
                        )
                    )
                )
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro list ((type ARG1))
                (allow ARG1 home_cache_file list_dir_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage ((type ARG1))
                (call manage_dirs
                    (
                        ARG1
                    )
                )
                (call manage_files
                    (
                        ARG1
                    )
                )
                (call manage_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro manage_dirs ((type ARG1))
                (allow ARG1 home_cache_file manage_dir_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_files ((type ARG1))
                (allow ARG1 home_cache_file manage_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_lnk_files ((type ARG1))
                (allow ARG1 home_cache_file manage_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro mmap ((type ARG1))
                (allow ARG1 home_cache_file mmap_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
                (typetransition ARG1 home_cache_file ARG3 ARG4 ARG2)
                    (call rw_dirs
                    (
                        ARG1
                    )
                )
            )

            (macro read ((type ARG1))
                (call list
                    (
                        ARG1
                    )
                )
                (call read_files
                    (
                        ARG1
                    )
                )
                (call read_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro read_files ((type ARG1))
                (allow ARG1 home_cache_file read_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_lnk_files ((type ARG1))
                (allow ARG1 home_cache_file read_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel ((type ARG1))
                (call relabel_dirs
                    (
                        ARG1
                    )
                )
                (call relabel_files
                    (
                        ARG1
                    )
                )
                (call relabel_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_dirs ((type ARG1))
                (allow ARG1 home_cache_file relabel_dir_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_files ((type ARG1))
                (allow ARG1 home_cache_file relabel_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_lnk_files ((type ARG1))
                (allow ARG1 home_cache_file relabel_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom ((type ARG1))
                (call relabelfrom_dirs
                    (
                        ARG1
                    )
                )
                (call relabelfrom_files
                    (
                        ARG1
                    )
                )
                (call relabelfrom_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_dirs ((type ARG1))
                (allow ARG1 home_cache_file relabelfrom_dir_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_files ((type ARG1))
                (allow ARG1 home_cache_file relabelfrom_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_lnk_files ((type ARG1))
                (allow ARG1 home_cache_file relabelfrom_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto ((type ARG1))
                (call relabelto_dirs
                    (
                        ARG1
                    )
                )
                (call relabelto_files
                    (
                        ARG1
                    )
                )
                (call relabelto_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_dirs ((type ARG1))
                (allow ARG1 home_cache_file relabelto_dir_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_files ((type ARG1))
                (allow ARG1 home_cache_file relabelto_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_lnk_files ((type ARG1))
                (allow ARG1 home_cache_file relabelto_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename ((type ARG1))
                (call rename_dirs
                    (
                        ARG1
                    )
                )
                (call rename_files
                    (
                        ARG1
                    )
                )
                (call rename_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro rename_dirs ((type ARG1))
                (allow ARG1 home_cache_file rename_dir_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_files ((type ARG1))
                (allow ARG1 home_cache_file rename_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_lnk_files ((type ARG1))
                (allow ARG1 home_cache_file rename_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw ((type ARG1))
                (call rw_dirs
                    (
                        ARG1
                    )
                )
                (call rw_files
                    (
                        ARG1
                    )
                )
                (call rw_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro rw_dirs ((type ARG1))
                (allow ARG1 home_cache_file rw_dir_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_files ((type ARG1))
                (allow ARG1 home_cache_file rw_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_lnk_files ((type ARG1))
                (allow ARG1 home_cache_file rw_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro search ((type ARG1))
                (allow ARG1 home_cache_file search_dir_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr ((type ARG1))
                (call setattr_dirs
                    (
                        ARG1
                    )
                )
                (call setattr_files
                    (
                        ARG1
                    )
                )
                (call setattr_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_dirs ((type ARG1))
                (allow ARG1 home_cache_file
                    (dir
                        (
                            setattr
                        )
                    )
                )
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_files ((type ARG1))
                (allow ARG1 home_cache_file
                    (file
                        (
                            setattr
                        )
                    )
                )
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_lnk_files ((type ARG1))
                (allow ARG1 home_cache_file
                    (lnk_file
                        (
                            setattr
                        )
                    )
                )
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro write ((type ARG1))
                (call write_dirs
                    (
                        ARG1
                    )
                )
                (call write_files
                    (
                        ARG1
                    )
                )
                (call write_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro write_dirs ((type ARG1))
                (allow ARG1 home_cache_file write_dir_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_files ((type ARG1))
                (allow ARG1 home_cache_file write_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_lnk_files ((type ARG1))
                (allow ARG1 home_cache_file write_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
            )

            ;
            ; users.home_cache_file.obj_template policy
            ;

            (blockabstract obj_template)

            (blockinherit users.home_cache_file.obj_stub)
        )
    )

    ;
    ; Users home_cert name space
    ;

    (block home_cert

        ;
        ; home_cert contexts
        ;

        (filecon "HOME_DIR/\.pki(/.*)?" any home_file_context)

        ;
        ; home_cert macros
        ;

        (macro home_dir_obj_type_transition ((type ARG1))
            (call home_dir.obj_type_transition
                (
                    ARG1 home_file dir ".pki"
                )
            )
        )

        ;
        ; home_cert policy
        ;

        (blockinherit home_file.obj_template)
    )

    ;
    ; Users home_commmands name space
    ;

    (block home_commands

        ;
        ; home_commands contexts
        ;

        (filecon "HOME_DIR/\.local/bin(/.*)?" any home_file_context)

        ;
        ; home_commands macros
        ;

        (macro add_entries ((type ARG1))
            (allow ARG1 home_file add_entry_dir_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro append_files ((type ARG1))
            (allow ARG1 home_file append_file_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro create ((type ARG1))
            (call create_dirs
                (
                    ARG1
                )
            )
            (call create_files
                (
                    ARG1
                )
            )
            (call create_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro create_dirs ((type ARG1))
            (allow ARG1 home_file create_dir_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro create_files ((type ARG1))
            (allow ARG1 home_file create_file_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro create_lnk_files ((type ARG1))
            (allow ARG1 home_file create_lnk_file_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro del_entries ((type ARG1))
            (allow ARG1 home_file del_entry_dir_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro delete ((type ARG1))
            (call delete_dirs
                (
                    ARG1
                )
            )
            (call delete_files
                (
                    ARG1
                )
            )
            (call delete_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro delete_dirs ((type ARG1))
            (allow ARG1 home_file delete_dir_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro delete_files ((type ARG1))
            (allow ARG1 home_file delete_file_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro delete_lnk_files ((type ARG1))
            (allow ARG1 home_file delete_lnk_file_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

		(macro entry ((type ARG1))
            (allow ARG1 home_file
                (file
                    (
                        entrypoint
                    )
                )
            )
            (call mmap
                (
                    ARG1
                )
            )
        )

        (macro execute ((type ARG1))
            (allow ARG1 home_file exec_file_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro getattr ((type ARG1))
            (call getattr_dirs
                (
                    ARG1
                )
            )
            (call getattr_files
                (
                    ARG1
                )
            )
            (call getattr_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro getattr_dirs ((type ARG1))
            (allow ARG1 home_file
                (dir
                    (
                        getattr
                    )
                )
            )
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro getattr_files ((type ARG1))
            (allow ARG1 home_file
                (file
                    (
                        getattr
                    )
                )
            )
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro getattr_lnk_files ((type ARG1))
            (allow ARG1 home_file
                (lnk_file
                    (
                        getattr
                    )
                )
            )
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro generic_data_obj_type_transition ((type ARG1))
            (call generic_data.obj_type_transition
                (
                    ARG1 home_file dir "bin"
                )
            )
        )

        (macro home_file_auto_subj_type_transition ((type ARG1)(type ARG2))
            (typetransition ARG1 home_file process "*" ARG2)
			(call mmap
                (
                    ARG1
                )
            )
        )

        (macro list ((type ARG1))
            (allow ARG1 home_file list_dir_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro manage ((type ARG1))
            (call manage_dirs
                (
                    ARG1
                )
            )
            (call manage_files
                (
                    ARG1
                )
            )
            (call manage_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro manage_dirs ((type ARG1))
            (allow ARG1 home_file manage_dir_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro manage_files ((type ARG1))
            (allow ARG1 home_file manage_file_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro manage_lnk_files ((type ARG1))
            (allow ARG1 home_file manage_lnk_file_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro mmap ((type ARG1))
            (allow ARG1 home_file mmap_file_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
            (typetransition ARG1 home_file ARG3 ARG4 ARG2)
            (call rw_dirs
                (
                    ARG1
                )
            )
        )

        (macro read ((type ARG1))
            (call list
                (
                    ARG1
                )
            )
            (call read_files
                (
                    ARG1
                )
            )
            (call read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro read_files ((type ARG1))
            (allow ARG1 home_file read_file_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro read_lnk_files ((type ARG1))
            (allow ARG1 home_file read_lnk_file_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro relabel ((type ARG1))
            (call relabel_dirs
                (
                    ARG1
                )
            )
            (call relabel_files
                (
                    ARG1
                )
            )
            (call relabel_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro relabel_dirs ((type ARG1))
            (allow ARG1 home_file relabel_dir_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro relabel_files ((type ARG1))
            (allow ARG1 home_file relabel_file_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro relabel_lnk_files ((type ARG1))
            (allow ARG1 home_file relabel_lnk_file_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom ((type ARG1))
            (call relabelfrom_dirs
                (
                    ARG1
                )
            )
            (call relabelfrom_files
                (
                    ARG1
                )
            )
            (call relabelfrom_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_dirs ((type ARG1))
            (allow ARG1 home_file relabelfrom_dir_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_files ((type ARG1))
            (allow ARG1 home_file relabelfrom_file_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_lnk_files ((type ARG1))
            (allow ARG1 home_file relabelfrom_lnk_file_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro relabelto ((type ARG1))
            (call relabelto_dirs
                (
                    ARG1
                )
            )
            (call relabelto_files
                (
                    ARG1
                )
            )
            (call relabelto_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro relabelto_dirs ((type ARG1))
            (allow ARG1 home_file relabelto_dir_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro relabelto_files ((type ARG1))
            (allow ARG1 home_file relabelto_file_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro relabelto_lnk_files ((type ARG1))
            (allow ARG1 home_file relabelto_lnk_file_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro rename ((type ARG1))
            (call rename_dirs
                (
                    ARG1
                )
            )
            (call rename_files
                (
                    ARG1
                )
            )
            (call rename_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro rename_dirs ((type ARG1))
            (allow ARG1 home_file rename_dir_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro rename_files ((type ARG1))
            (allow ARG1 home_file rename_file_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro rename_lnk_files ((type ARG1))
            (allow ARG1 home_file rename_lnk_file_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro rw ((type ARG1))
            (call rw_dirs
                (
                    ARG1
                )
            )
            (call rw_files
                (
                    ARG1
                )
            )
            (call rw_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro rw_dirs ((type ARG1))
            (allow ARG1 home_file rw_dir_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro rw_files ((type ARG1))
            (allow ARG1 home_file rw_file_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro rw_lnk_files ((type ARG1))
            (allow ARG1 home_file rw_lnk_file_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro search ((type ARG1))
            (allow ARG1 home_file search_dir_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro setattr ((type ARG1))
            (call setattr_dirs
                (
                    ARG1
                )
            )
            (call setattr_files
                (
                    ARG1
                )
            )
            (call setattr_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro setattr_dirs ((type ARG1))
            (allow ARG1 home_file
                (dir
                    (
                        setattr
                    )
                )
            )
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro setattr_files ((type ARG1))
            (allow ARG1 home_file
                (file
                    (
                        setattr
                    )
                )
            )
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro setattr_lnk_files ((type ARG1))
            (allow ARG1 home_file
                (lnk_file
                    (
                        setattr
                    )
                )
            )
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro write ((type ARG1))
            (call write_dirs
                (
                    ARG1
                )
            )
            (call write_files
                (
                    ARG1
                )
            )
            (call write_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro write_dirs ((type ARG1))
            (allow ARG1 home_file write_dir_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro write_files ((type ARG1))
            (allow ARG1 home_file write_file_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro write_lnk_files ((type ARG1))
            (allow ARG1 home_file write_lnk_file_perms)
            (call generic_data.search
                (
                    ARG1
                )
            )
            (call generic_home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        ;
        ; home_commands policy
        ;

        (blockinherit home_file.obj_stub)

        (call cmd.cmd_file.obj_type
            (
                home_file
            )
        )
    )

    ;
    ; Users home_config_file name space
    ;

    (block home_config_file

        ;
        ; home_config_file macros
        ;

        (blockinherit obj_macro_template)

        ;
        ; home_config_file policy
        ;

        (typeattribute obj_type_attribute)

        (call home_file.obj_type
            (
                obj_type_attribute
            )
        )

        ;
        ; home_config_file templates
        ;

        (block obj_macro_template

            ;
            ; users.home_config_file.obj_macro_template macros
            ;

            (macro add_entries ((type ARG1))
                (allow ARG1 obj_type_attribute add_entry_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro append_files ((type ARG1))
                (allow ARG1 obj_type_attribute append_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro create ((type ARG1))
                (call create_dirs
                    (
                        ARG1
                    )
                )
                (call create_files
                    (
                        ARG1
                    )
                )
                (call create_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro create_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute create_dir_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_files ((type ARG1))
                (allow ARG1 obj_type_attribute create_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute create_lnk_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro del_entries ((type ARG1))
                (allow ARG1 obj_type_attribute del_entry_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete ((type ARG1))
                (call delete_dirs
                    (
                        ARG1
                    )
                )
                (call delete_files
                    (
                        ARG1
                    )
                )
                (call delete_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro delete_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute delete_dir_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_files ((type ARG1))
                (allow ARG1 obj_type_attribute delete_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute delete_lnk_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro execute ((type ARG1))
                (allow ARG1 obj_type_attribute exec_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr ((type ARG1))
                (call getattr_dirs
                    (
                        ARG1
                    )
                )
                (call getattr_files
                    (
                        ARG1
                    )
                )
                (call getattr_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (dir
                        (
                            getattr
                        )
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (file
                        (
                            getattr
                        )
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (lnk_file
                        (
                            getattr
                        )
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro list ((type ARG1))
                (allow ARG1 obj_type_attribute list_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage ((type ARG1))
                (call manage_dirs
                    (
                        ARG1
                    )
                )
                (call manage_files
                    (
                        ARG1
                    )
                )
                (call manage_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro manage_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute manage_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_files ((type ARG1))
                (allow ARG1 obj_type_attribute manage_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute manage_lnk_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro mmap ((type ARG1))
                (allow ARG1 obj_type_attribute mmap_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro obj_type ((type ARG1))
                (typeattributeset obj_type_attribute ARG1)
            )

            (macro read ((type ARG1))
                (call list
                    (
                        ARG1
                    )
                )
                (call read_files
                    (
                        ARG1
                    )
                )
                (call read_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro read_files ((type ARG1))
                (allow ARG1 obj_type_attribute read_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute read_lnk_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel ((type ARG1))
                (call relabel_dirs
                    (
                        ARG1
                    )
                )
                (call relabel_files
                    (
                        ARG1
                    )
                )
                (call relabel_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_dir_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_lnk_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom ((type ARG1))
                (call relabelfrom_dirs
                    (
                        ARG1
                    )
                )
                (call relabelfrom_files
                    (
                        ARG1
                    )
                )
                (call relabelfrom_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_dir_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_lnk_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto ((type ARG1))
                (call relabelto_dirs
                    (
                        ARG1
                    )
                )
                (call relabelto_files
                    (
                        ARG1
                    )
                )
                (call relabelto_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_dir_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_lnk_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename ((type ARG1))
                (call rename_dirs
                    (
                        ARG1
                    )
                )
                (call rename_files
                    (
                        ARG1
                    )
                )
                (call rename_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro rename_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute rename_dir_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_files ((type ARG1))
                (allow ARG1 obj_type_attribute rename_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute rename_lnk_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw ((type ARG1))
                (call rw_dirs
                    (
                        ARG1
                    )
                )
                (call rw_files
                    (
                        ARG1
                    )
                )
                (call rw_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro rw_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute rw_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_files ((type ARG1))
                (allow ARG1 obj_type_attribute rw_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute rw_lnk_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro search ((type ARG1))
                (allow ARG1 obj_type_attribute search_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr ((type ARG1))
                (call setattr_dirs
                    (
                        ARG1
                    )
                )
                (call setattr_files
                    (
                        ARG1
                    )
                )
                (call setattr_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (dir
                        (
                            setattr
                        )
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (file
                        (
                            setattr
                        )
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (lnk_file
                        (
                            setattr
                        )
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro write ((type ARG1))
                (call write_dirs
                    (
                        ARG1
                    )
                )
                (call write_files
                    (
                        ARG1
                    )
                )
                (call write_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro write_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute write_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_files ((type ARG1))
                (allow ARG1 obj_type_attribute write_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute write_lnk_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            ;
            ; users.home_config_file.obj_macro_template policy
            ;

            (blockabstract obj_macro_template)
        )

        (block obj_stub

            ;
            ; users.home_config_file.obj_stub contexts
            ;

            (context home_config_file_context
                (
                    sys.id
                    sys.role
                    home_config_file
                        (
                            systemlow
                            systemlow
                        )
                )
            )

            ;
            ; users.home_config_file.obj_stub policy
            ;

            (blockabstract obj_stub)

            (type home_config_file)
            (call users.home_config_file.obj_type
                (
                    home_config_file
                )
            )
        )

        (block obj_template

            ;
            ; users.home_config_file.obj_template macros
            ;

            (macro add_entries ((type ARG1))
                (allow ARG1 home_config_file add_entry_dir_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro append_files ((type ARG1))
                (allow ARG1 home_config_file append_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro create ((type ARG1))
                (call create_dirs
                    (
                        ARG1
                    )
                )
                (call create_files
                    (
                        ARG1
                    )
                )
                (call create_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro create_dirs ((type ARG1))
                (allow ARG1 home_config_file create_dir_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_files ((type ARG1))
                (allow ARG1 home_config_file create_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_lnk_files ((type ARG1))
                (allow ARG1 home_config_file create_lnk_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro del_entries ((type ARG1))
                (allow ARG1 home_config_file del_entry_dir_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete ((type ARG1))
                (call delete_dirs
                    (
                        ARG1
                    )
                )
                (call delete_files
                    (
                        ARG1
                    )
                )
                (call delete_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro delete_dirs ((type ARG1))
                (allow ARG1 home_config_file delete_dir_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_files ((type ARG1))
                (allow ARG1 home_config_file delete_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_lnk_files ((type ARG1))
                (allow ARG1 home_config_file delete_lnk_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro execute ((type ARG1))
                (allow ARG1 home_config_file exec_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr ((type ARG1))
                (call getattr_dirs
                    (
                        ARG1
                    )
                )
                (call getattr_files
                    (
                        ARG1
                    )
                )
                (call getattr_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_dirs ((type ARG1))
                (allow ARG1 home_config_file
                    (dir
                        (
                            getattr
                        )
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_files ((type ARG1))
                (allow ARG1 home_config_file
                    (file
                        (
                            getattr
                        )
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_lnk_files ((type ARG1))
                (allow ARG1 home_config_file
                    (lnk_file
                        (
                            getattr
                        )
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro list ((type ARG1))
                (allow ARG1 home_config_file list_dir_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage ((type ARG1))
                (call manage_dirs
                    (
                        ARG1
                    )
                )
                (call manage_files
                    (
                        ARG1
                    )
                )
                (call manage_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro manage_dirs ((type ARG1))
                (allow ARG1 home_config_file manage_dir_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_files ((type ARG1))
                (allow ARG1 home_config_file manage_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_lnk_files ((type ARG1))
                (allow ARG1 home_config_file manage_lnk_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro mmap ((type ARG1))
                (allow ARG1 home_config_file mmap_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
                (typetransition ARG1 home_config_file ARG3 ARG4 ARG2)
                    (call rw_dirs
                    (
                        ARG1
                    )
                )
            )

            (macro read ((type ARG1))
                (call list
                    (
                        ARG1
                    )
                )
                (call read_files
                    (
                        ARG1
                    )
                )
                (call read_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro read_files ((type ARG1))
                (allow ARG1 home_config_file read_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_lnk_files ((type ARG1))
                (allow ARG1 home_config_file read_lnk_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel ((type ARG1))
                (call relabel_dirs
                    (
                        ARG1
                    )
                )
                (call relabel_files
                    (
                        ARG1
                    )
                )
                (call relabel_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_dirs ((type ARG1))
                (allow ARG1 home_config_file relabel_dir_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_files ((type ARG1))
                (allow ARG1 home_config_file relabel_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_lnk_files ((type ARG1))
                (allow ARG1 home_config_file relabel_lnk_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom ((type ARG1))
                (call relabelfrom_dirs
                    (
                        ARG1
                    )
                )
                (call relabelfrom_files
                    (
                        ARG1
                    )
                )
                (call relabelfrom_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_dirs ((type ARG1))
                (allow ARG1 home_config_file relabelfrom_dir_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_files ((type ARG1))
                (allow ARG1 home_config_file relabelfrom_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_lnk_files ((type ARG1))
                (allow ARG1 home_config_file relabelfrom_lnk_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto ((type ARG1))
                (call relabelto_dirs
                    (
                        ARG1
                    )
                )
                (call relabelto_files
                    (
                        ARG1
                    )
                )
                (call relabelto_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_dirs ((type ARG1))
                (allow ARG1 home_config_file relabelto_dir_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_files ((type ARG1))
                (allow ARG1 home_config_file relabelto_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_lnk_files ((type ARG1))
                (allow ARG1 home_config_file relabelto_lnk_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename ((type ARG1))
                (call rename_dirs
                    (
                        ARG1
                    )
                )
                (call rename_files
                    (
                        ARG1
                    )
                )
                (call rename_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro rename_dirs ((type ARG1))
                (allow ARG1 home_config_file rename_dir_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_files ((type ARG1))
                (allow ARG1 home_config_file rename_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_lnk_files ((type ARG1))
                (allow ARG1 home_config_file rename_lnk_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw ((type ARG1))
                (call rw_dirs
                    (
                        ARG1
                    )
                )
                (call rw_files
                    (
                        ARG1
                    )
                )
                (call rw_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro rw_dirs ((type ARG1))
                (allow ARG1 home_config_file rw_dir_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_files ((type ARG1))
                (allow ARG1 home_config_file rw_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_lnk_files ((type ARG1))
                (allow ARG1 home_config_file rw_lnk_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro search ((type ARG1))
                (allow ARG1 home_config_file search_dir_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr ((type ARG1))
                (call setattr_dirs
                    (
                        ARG1
                    )
                )
                (call setattr_files
                    (
                        ARG1
                    )
                )
                (call setattr_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_dirs ((type ARG1))
                (allow ARG1 home_config_file
                    (dir
                        (
                            setattr
                        )
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_files ((type ARG1))
                (allow ARG1 home_config_file
                    (file
                        (
                            setattr
                        )
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_lnk_files ((type ARG1))
                (allow ARG1 home_config_file
                    (lnk_file
                        (
                            setattr
                        )
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro write ((type ARG1))
                (call write_dirs
                    (
                        ARG1
                    )
                )
                (call write_files
                    (
                        ARG1
                    )
                )
                (call write_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro write_dirs ((type ARG1))
                (allow ARG1 home_config_file write_dir_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_files ((type ARG1))
                (allow ARG1 home_config_file write_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_lnk_files ((type ARG1))
                (allow ARG1 home_config_file write_lnk_file_perms)
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
            )

            ;
            ; users.home_config_file.obj_template policy
            ;

            (blockabstract obj_template)

            (blockinherit users.home_config_file.obj_stub)
        )
    )

    ;
    ; Users home_data_file name space
    ;

    (block home_data_file

        ;
        ; home_data_file macros
        ;

        (blockinherit obj_macro_template)

        ;
        ; home_data_file policy
        ;

        (typeattribute obj_type_attribute)

        (call home_file.obj_type
            (
                obj_type_attribute
            )
        )

        ;
        ; home_data_file templates
        ;

        (block obj_macro_template

            ;
            ; users.home_data_file.obj_macro_template macros
            ;

            (macro add_entries ((type ARG1))
                (allow ARG1 obj_type_attribute add_entry_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro append_files ((type ARG1))
                (allow ARG1 obj_type_attribute append_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro create ((type ARG1))
                (call create_dirs
                    (
                        ARG1
                    )
                )
                (call create_files
                    (
                        ARG1
                    )
                )
                (call create_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro create_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute create_dir_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_files ((type ARG1))
                (allow ARG1 obj_type_attribute create_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute create_lnk_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro del_entries ((type ARG1))
                (allow ARG1 obj_type_attribute del_entry_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete ((type ARG1))
                (call delete_dirs
                    (
                        ARG1
                    )
                )
                (call delete_files
                    (
                        ARG1
                    )
                )
                (call delete_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro delete_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute delete_dir_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_files ((type ARG1))
                (allow ARG1 obj_type_attribute delete_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute delete_lnk_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro execute ((type ARG1))
                (allow ARG1 obj_type_attribute exec_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr ((type ARG1))
                (call getattr_dirs
                    (
                        ARG1
                    )
                )
                (call getattr_files
                    (
                        ARG1
                    )
                )
                (call getattr_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (dir
                        (
                            getattr
                        )
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (file
                        (
                            getattr
                        )
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (lnk_file
                        (
                            getattr
                        )
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro list ((type ARG1))
                (allow ARG1 obj_type_attribute list_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage ((type ARG1))
                (call manage_dirs
                    (
                        ARG1
                    )
                )
                (call manage_files
                    (
                        ARG1
                    )
                )
                (call manage_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro manage_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute manage_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_files ((type ARG1))
                (allow ARG1 obj_type_attribute manage_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute manage_lnk_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro mmap ((type ARG1))
                (allow ARG1 obj_type_attribute mmap_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro obj_type ((type ARG1))
                (typeattributeset obj_type_attribute ARG1)
            )

            (macro read ((type ARG1))
                (call list
                    (
                        ARG1
                    )
                )
                (call read_files
                    (
                        ARG1
                    )
                )
                (call read_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro read_files ((type ARG1))
                (allow ARG1 obj_type_attribute read_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute read_lnk_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel ((type ARG1))
                (call relabel_dirs
                    (
                        ARG1
                    )
                )
                (call relabel_files
                    (
                        ARG1
                    )
                )
                (call relabel_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_dir_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_lnk_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom ((type ARG1))
                (call relabelfrom_dirs
                    (
                        ARG1
                    )
                )
                (call relabelfrom_files
                    (
                        ARG1
                    )
                )
                (call relabelfrom_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_dir_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_lnk_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto ((type ARG1))
                (call relabelto_dirs
                    (
                        ARG1
                    )
                )
                (call relabelto_files
                    (
                        ARG1
                    )
                )
                (call relabelto_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_dir_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_lnk_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename ((type ARG1))
                (call rename_dirs
                    (
                        ARG1
                    )
                )
                (call rename_files
                    (
                        ARG1
                    )
                )
                (call rename_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro rename_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute rename_dir_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_files ((type ARG1))
                (allow ARG1 obj_type_attribute rename_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute rename_lnk_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw ((type ARG1))
                (call rw_dirs
                    (
                        ARG1
                    )
                )
                (call rw_files
                    (
                        ARG1
                    )
                )
                (call rw_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro rw_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute rw_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_files ((type ARG1))
                (allow ARG1 obj_type_attribute rw_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute rw_lnk_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro search ((type ARG1))
                (allow ARG1 obj_type_attribute search_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr ((type ARG1))
                (call setattr_dirs
                    (
                        ARG1
                    )
                )
                (call setattr_files
                    (
                        ARG1
                    )
                )
                (call setattr_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (dir
                        (
                            setattr
                        )
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (file
                        (
                            setattr
                        )
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (lnk_file
                        (
                            setattr
                        )
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro write ((type ARG1))
                (call write_dirs
                    (
                        ARG1
                    )
                )
                (call write_files
                    (
                        ARG1
                    )
                )
                (call write_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro write_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute write_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_files ((type ARG1))
                (allow ARG1 obj_type_attribute write_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute write_lnk_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            ;
            ; users.home_data_file.obj_macro_template policy
            ;

            (blockabstract obj_macro_template)
        )

        (block obj_stub

            ;
            ; users.home_data_file.obj_stub contexts
            ;

            (context home_data_file_context
                (
                    sys.id
                    sys.role
                    home_data_file
                        (
                            systemlow
                            systemlow
                        )
                )
            )

            ;
            ; users.home_data_file.obj_stub policy
            ;

            (blockabstract obj_stub)

            (type home_data_file)
            (call users.home_data_file.obj_type
                (
                    home_data_file
                )
            )
        )

        (block obj_template

            ;
            ; users.home_data_file.obj_template macros
            ;

            (macro add_entries ((type ARG1))
                (allow ARG1 home_data_file add_entry_dir_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro append_files ((type ARG1))
                (allow ARG1 home_data_file append_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro create ((type ARG1))
                (call create_dirs
                    (
                        ARG1
                    )
                )
                (call create_files
                    (
                        ARG1
                    )
                )
                (call create_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro create_dirs ((type ARG1))
                (allow ARG1 home_data_file create_dir_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_files ((type ARG1))
                (allow ARG1 home_data_file create_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_lnk_files ((type ARG1))
                (allow ARG1 home_data_file create_lnk_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro del_entries ((type ARG1))
                (allow ARG1 home_data_file del_entry_dir_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete ((type ARG1))
                (call delete_dirs
                    (
                        ARG1
                    )
                )
                (call delete_files
                    (
                        ARG1
                    )
                )
                (call delete_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro delete_dirs ((type ARG1))
                (allow ARG1 home_data_file delete_dir_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_files ((type ARG1))
                (allow ARG1 home_data_file delete_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_lnk_files ((type ARG1))
                (allow ARG1 home_data_file delete_lnk_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro execute ((type ARG1))
                (allow ARG1 home_data_file exec_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr ((type ARG1))
                (call getattr_dirs
                    (
                        ARG1
                    )
                )
                (call getattr_files
                    (
                        ARG1
                    )
                )
                (call getattr_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_dirs ((type ARG1))
                (allow ARG1 home_data_file
                    (dir
                        (
                            getattr
                        )
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_files ((type ARG1))
                (allow ARG1 home_data_file
                    (file
                        (
                            getattr
                        )
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_lnk_files ((type ARG1))
                (allow ARG1 home_data_file
                    (lnk_file
                        (
                            getattr
                        )
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro list ((type ARG1))
                (allow ARG1 home_data_file list_dir_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage ((type ARG1))
                (call manage_dirs
                    (
                        ARG1
                    )
                )
                (call manage_files
                    (
                        ARG1
                    )
                )
                (call manage_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro manage_dirs ((type ARG1))
                (allow ARG1 home_data_file manage_dir_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_files ((type ARG1))
                (allow ARG1 home_data_file manage_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_lnk_files ((type ARG1))
                (allow ARG1 home_data_file manage_lnk_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro mmap ((type ARG1))
                (allow ARG1 home_data_file mmap_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
                (typetransition ARG1 home_data_file ARG3 ARG4 ARG2)
                    (call rw_dirs
                    (
                        ARG1
                    )
                )
            )

            (macro read ((type ARG1))
                (call list
                    (
                        ARG1
                    )
                )
                (call read_files
                    (
                        ARG1
                    )
                )
                (call read_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro read_files ((type ARG1))
                (allow ARG1 home_data_file read_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_lnk_files ((type ARG1))
                (allow ARG1 home_data_file read_lnk_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel ((type ARG1))
                (call relabel_dirs
                    (
                        ARG1
                    )
                )
                (call relabel_files
                    (
                        ARG1
                    )
                )
                (call relabel_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_dirs ((type ARG1))
                (allow ARG1 home_data_file relabel_dir_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_files ((type ARG1))
                (allow ARG1 home_data_file relabel_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_lnk_files ((type ARG1))
                (allow ARG1 home_data_file relabel_lnk_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom ((type ARG1))
                (call relabelfrom_dirs
                    (
                        ARG1
                    )
                )
                (call relabelfrom_files
                    (
                        ARG1
                    )
                )
                (call relabelfrom_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_dirs ((type ARG1))
                (allow ARG1 home_data_file relabelfrom_dir_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_files ((type ARG1))
                (allow ARG1 home_data_file relabelfrom_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_lnk_files ((type ARG1))
                (allow ARG1 home_data_file relabelfrom_lnk_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto ((type ARG1))
                (call relabelto_dirs
                    (
                        ARG1
                    )
                )
                (call relabelto_files
                    (
                        ARG1
                    )
                )
                (call relabelto_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_dirs ((type ARG1))
                (allow ARG1 home_data_file relabelto_dir_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_files ((type ARG1))
                (allow ARG1 home_data_file relabelto_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_lnk_files ((type ARG1))
                (allow ARG1 home_data_file relabelto_lnk_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename ((type ARG1))
                (call rename_dirs
                    (
                        ARG1
                    )
                )
                (call rename_files
                    (
                        ARG1
                    )
                )
                (call rename_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro rename_dirs ((type ARG1))
                (allow ARG1 home_data_file rename_dir_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_files ((type ARG1))
                (allow ARG1 home_data_file rename_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_lnk_files ((type ARG1))
                (allow ARG1 home_data_file rename_lnk_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw ((type ARG1))
                (call rw_dirs
                    (
                        ARG1
                    )
                )
                (call rw_files
                    (
                        ARG1
                    )
                )
                (call rw_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro rw_dirs ((type ARG1))
                (allow ARG1 home_data_file rw_dir_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_files ((type ARG1))
                (allow ARG1 home_data_file rw_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_lnk_files ((type ARG1))
                (allow ARG1 home_data_file rw_lnk_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro search ((type ARG1))
                (allow ARG1 home_data_file search_dir_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr ((type ARG1))
                (call setattr_dirs
                    (
                        ARG1
                    )
                )
                (call setattr_files
                    (
                        ARG1
                    )
                )
                (call setattr_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_dirs ((type ARG1))
                (allow ARG1 home_data_file
                    (dir
                        (
                            setattr
                        )
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_files ((type ARG1))
                (allow ARG1 home_data_file
                    (file
                        (
                            setattr
                        )
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_lnk_files ((type ARG1))
                (allow ARG1 home_data_file
                    (lnk_file
                        (
                            setattr
                        )
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro write ((type ARG1))
                (call write_dirs
                    (
                        ARG1
                    )
                )
                (call write_files
                    (
                        ARG1
                    )
                )
                (call write_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro write_dirs ((type ARG1))
                (allow ARG1 home_data_file write_dir_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_files ((type ARG1))
                (allow ARG1 home_data_file write_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_lnk_files ((type ARG1))
                (allow ARG1 home_data_file write_lnk_file_perms)
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            ;
            ; users.home_data_file.obj_template policy
            ;

            (blockabstract obj_template)

            (blockinherit users.home_data_file.obj_stub)
        )
    )

    ;
    ; Users home_dir name space
    ;

    (block home_dir

        ;
        ; home_dir contexts
        ;

        (filecon "HOME_DIR" dir file_context)

        ;
        ; home_dir macros
        ;

        (macro add_entries ((type ARG1))
            (allow ARG1 file add_entry_dir_perms)
            (call files.home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro create_dirs ((type ARG1))
            (allow ARG1 file
                (dirs
                    (
                        create
                    )
                )
            )
            (call files.home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro del_entries ((type ARG1))
            (allow ARG1 file del_entry_dir_perms)
            (call files.home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro delete_dirs ((type ARG1))
            (allow ARG1 file
                (dirs
                    (
                        delete
                    )
                )
            )
            (call files.home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro getattr_dirs ((type ARG1))
            (allow ARG1 file
                (dirs
                    (
                        getattr
                    )
                )
            )
            (call files.home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro home_obj_type_transition ((type ARG1))
            (call files.home.obj_type_transition
                (
                    ARG1 file dir "*"
                )
            )
        )

        (macro list ((type ARG1))
            (allow ARG1 file list_dir_perms)
            (call files.home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro manage_dirs ((type ARG1))
            (allow ARG1 file
                (dirs
                    (
                        manage
                    )
                )
            )
            (call files.home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
            (typetransition ARG1 file ARG3 ARG4 ARG2)
            (call rw_dirs
                (
                    ARG1
                )
            )
        )

        (macro relabel_dirs ((type ARG1))
            (allow ARG1 file
                (dirs
                    (
                        relabel
                    )
                )
            )
            (call files.home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_dirs ((type ARG1))
            (allow ARG1 file
                (dirs
                    (
                        relabelfrom
                    )
                )
            )
            (call files.home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro relabelto_dirs ((type ARG1))
            (allow ARG1 file
                (dirs
                    (
                        relabelto
                    )
                )
            )
            (call files.home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro rename_dirs ((type ARG1))
            (allow ARG1 file
                (dirs
                    (
                        rename
                    )
                )
            )
            (call files.home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro rw_dirs ((type ARG1))
            (allow ARG1 file
                (dirs
                    (
                        rw
                    )
                )
            )
            (call files.home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro search ((type ARG1))
            (allow ARG1 file search_dir_perms)
            (call files.home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro setattr_dirs ((type ARG1))
            (allow ARG1 file
                (dirs
                    (
                        setattr
                    )
                )
            )
            (call files.home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        (macro write_dirs ((type ARG1))
            (allow ARG1 file
                (dirs
                    (
                        write
                    )
                )
            )
            (call files.home.read_lnk_files
                (
                    ARG1
                )
            )
        )

        ;
        ; home_dir policy
        ;

        (blockinherit files.file.obj_stub)

        (call sys.mountpoint.obj_type
            (
                file
            )
        )
    )

    ;
    ; Users home_file name space
    ;

    (block home_file

        ;
        ; home_file macros
        ;

        (blockinherit obj_macro_template)

        ;
        ; home_file policy
        ;

        (typeattribute obj_type_attribute)

        (call files.obj_type
            (
                obj_type_attribute
            )
        )

        (optional home_file_optional_tmpfiles
            (call tmpfiles.exception_obj_type
                (
                    obj_type_attribute
                )
            )
        )

        ;
        ; home_file templates
        ;

        (block obj_macro_template

            ;
            ; users.home_file.obj_macro_template macros
            ;

            (macro dontaudit_rw ((type ARG1))
                (dontaudit ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            rw
                        )
                    )
                )
            )

            (macro add_entries ((type ARG1))
                (allow ARG1 obj_type_attribute add_entry_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro append_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute append_fifo_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro append_files ((type ARG1))
                (allow ARG1 obj_type_attribute append_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro create ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            create
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute create_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute create_fifo_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_files ((type ARG1))
                (allow ARG1 obj_type_attribute create_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute create_lnk_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute create_sock_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro del_entries ((type ARG1))
                (allow ARG1 obj_type_attribute del_entry_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            delete
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute delete_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute delete_fifo_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_files ((type ARG1))
                (allow ARG1 obj_type_attribute delete_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute delete_lnk_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute delete_sock_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro execute ((type ARG1))
                (allow ARG1 obj_type_attribute exec_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            getattr
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (dir
                        (
                            getattr
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (fifo_file
                        (
                            getattr
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (file
                        (
                            getattr
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (lnk_file
                        (
                            getattr
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (sock_file
                        (
                            getattr
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro list ((type ARG1))
                (allow ARG1 obj_type_attribute list_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            manage
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute manage_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute manage_fifo_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_files ((type ARG1))
                (allow ARG1 obj_type_attribute manage_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute manage_lnk_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute manage_sock_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro mmap ((type ARG1))
                (allow ARG1 obj_type_attribute mmap_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro obj_type ((type ARG1))
                (typeattributeset obj_type_attribute ARG1)
            )

            (macro read ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            read
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute read_fifo_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_files ((type ARG1))
                (allow ARG1 obj_type_attribute read_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute read_lnk_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute read_sock_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            relabel
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_fifo_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_lnk_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_sock_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            relabelfrom
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_fifo_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_lnk_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_sock_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            relabelto
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_fifo_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_lnk_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_sock_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            rename
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute rename_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute rename_fifo_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_files ((type ARG1))
                (allow ARG1 obj_type_attribute rename_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute rename_lnk_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute rename_sock_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            rw
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute rw_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute rw_fifo_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_files ((type ARG1))
                (allow ARG1 obj_type_attribute rw_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute rw_lnk_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute rw_sock_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro search ((type ARG1))
                (allow ARG1 obj_type_attribute search_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            setattr
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (dir
                        (
                            setattr
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (fifo_file
                        (
                            setattr
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (file
                        (
                            setattr
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (lnk_file
                        (
                            setattr
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (sock_file
                        (
                            setattr
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro write ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            write
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute write_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute write_fifo_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_files ((type ARG1))
                (allow ARG1 obj_type_attribute write_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute write_lnk_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute write_sock_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            ;
            ; users.home_file.obj_macro_template policy
            ;

            (blockabstract obj_macro_template)
        )

        (block obj_stub

            ;
            ; users.home_file.obj_stub contexts
            ;

            (context home_file_context
                (
                    sys.id
                    sys.role
                    home_file
                        (
                            systemlow
                            systemlow
                        )
                )
            )

            ;
            ; users.home_file.obj_stub policy
            ;

            (blockabstract obj_stub)

            (type home_file)
            (call users.home_file.obj_type
                (
                    home_file
                )
            )
        )

        (block obj_template

            ;
            ; users.home_file.obj_template macros
            ;

            (macro add_entries ((type ARG1))
                (allow ARG1 home_file add_entry_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro append_fifo_files ((type ARG1))
                (allow ARG1 home_file append_fifo_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro append_files ((type ARG1))
                (allow ARG1 home_file append_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro create ((type ARG1))
                (allow ARG1 home_file
                    (files_except_blk_and_chr
                        (
                            create
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_dirs ((type ARG1))
                (allow ARG1 home_file create_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_fifo_files ((type ARG1))
                (allow ARG1 home_file create_fifo_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_files ((type ARG1))
                (allow ARG1 home_file create_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_lnk_files ((type ARG1))
                (allow ARG1 home_file create_lnk_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_sock_files ((type ARG1))
                (allow ARG1 home_file create_sock_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro del_entries ((type ARG1))
                (allow ARG1 home_file del_entry_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete ((type ARG1))
                (allow ARG1 home_file
                    (files_except_blk_and_chr
                        (
                            delete
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_dirs ((type ARG1))
                (allow ARG1 home_file delete_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_fifo_files ((type ARG1))
                (allow ARG1 home_file delete_fifo_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_files ((type ARG1))
                (allow ARG1 home_file delete_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_lnk_files ((type ARG1))
                (allow ARG1 home_file delete_lnk_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_sock_files ((type ARG1))
                (allow ARG1 home_file delete_sock_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro execute ((type ARG1))
                (allow ARG1 home_file exec_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr ((type ARG1))
                (allow ARG1 home_file
                    (files_except_blk_and_chr
                        (
                            getattr
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_dirs ((type ARG1))
                (allow ARG1 home_file
                    (dir
                        (
                            getattr
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_fifo_files ((type ARG1))
                (allow ARG1 home_file
                    (fifo_file
                        (
                            getattr
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_files ((type ARG1))
                (allow ARG1 home_file
                    (file
                        (
                            getattr
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_lnk_files ((type ARG1))
                (allow ARG1 home_file
                    (lnk_file
                        (
                            getattr
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_sock_files ((type ARG1))
                (allow ARG1 home_file
                    (sock_file
                        (
                            getattr
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro list ((type ARG1))
                (allow ARG1 home_file list_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage ((type ARG1))
                (allow ARG1 home_file
                    (files_except_blk_and_chr
                        (
                            manage
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_dirs ((type ARG1))
                (allow ARG1 home_file manage_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_fifo_files ((type ARG1))
                (allow ARG1 home_file manage_fifo_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_files ((type ARG1))
                (allow ARG1 home_file manage_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_lnk_files ((type ARG1))
                (allow ARG1 home_file manage_lnk_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_sock_files ((type ARG1))
                (allow ARG1 home_file manage_sock_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro mmap ((type ARG1))
                (allow ARG1 home_file mmap_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
                (typetransition ARG1 home_file ARG3 ARG4 ARG2)
                    (call rw_dirs
                    (
                        ARG1
                    )
                )
            )

            (macro read ((type ARG1))
                (allow ARG1 home_file
                    (files_except_blk_and_chr
                        (
                            read
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_fifo_files ((type ARG1))
                (allow ARG1 home_file read_fifo_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_files ((type ARG1))
                (allow ARG1 home_file read_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_lnk_files ((type ARG1))
                (allow ARG1 home_file read_lnk_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_sock_files ((type ARG1))
                (allow ARG1 home_file read_sock_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel ((type ARG1))
                (allow ARG1 home_file
                    (files_except_blk_and_chr
                        (
                            relabel
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_dirs ((type ARG1))
                (allow ARG1 home_file relabel_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_fifo_files ((type ARG1))
                (allow ARG1 home_file relabel_fifo_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_files ((type ARG1))
                (allow ARG1 home_file relabel_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_lnk_files ((type ARG1))
                (allow ARG1 home_file relabel_lnk_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_sock_files ((type ARG1))
                (allow ARG1 home_file relabel_sock_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom ((type ARG1))
                (allow ARG1 home_file
                    (files_except_blk_and_chr
                        (
                            relabelfrom
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_dirs ((type ARG1))
                (allow ARG1 home_file relabelfrom_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_fifo_files ((type ARG1))
                (allow ARG1 home_file relabelfrom_fifo_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_files ((type ARG1))
                (allow ARG1 home_file relabelfrom_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_lnk_files ((type ARG1))
                (allow ARG1 home_file relabelfrom_lnk_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_sock_files ((type ARG1))
                (allow ARG1 home_file relabelfrom_sock_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto ((type ARG1))
                (allow ARG1 home_file
                    (files_except_blk_and_chr
                        (
                            relabelto
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_dirs ((type ARG1))
                (allow ARG1 home_file relabelto_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_fifo_files ((type ARG1))
                (allow ARG1 home_file relabelto_fifo_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_files ((type ARG1))
                (allow ARG1 home_file relabelto_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_lnk_files ((type ARG1))
                (allow ARG1 home_file relabelto_lnk_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_sock_files ((type ARG1))
                (allow ARG1 home_file relabelto_sock_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename ((type ARG1))
                (allow ARG1 home_file
                    (files_except_blk_and_chr
                        (
                            rename
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_dirs ((type ARG1))
                (allow ARG1 home_file rename_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_fifo_files ((type ARG1))
                (allow ARG1 home_file rename_fifo_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_files ((type ARG1))
                (allow ARG1 home_file rename_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_lnk_files ((type ARG1))
                (allow ARG1 home_file rename_lnk_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_sock_files ((type ARG1))
                (allow ARG1 home_file rename_sock_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw ((type ARG1))
                (allow ARG1 home_file
                    (files_except_blk_and_chr
                        (
                            rw
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_dirs ((type ARG1))
                (allow ARG1 home_file rw_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_fifo_files ((type ARG1))
                (allow ARG1 home_file rw_fifo_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_files ((type ARG1))
                (allow ARG1 home_file rw_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_lnk_files ((type ARG1))
                (allow ARG1 home_file rw_lnk_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_sock_files ((type ARG1))
                (allow ARG1 home_file rw_sock_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro search ((type ARG1))
                (allow ARG1 home_file search_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr ((type ARG1))
                (allow ARG1 home_file
                    (files_except_blk_and_chr
                        (
                            setattr
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_dirs ((type ARG1))
                (allow ARG1 home_file
                    (dir
                        (
                            setattr
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_fifo_files ((type ARG1))
                (allow ARG1 home_file
                    (fifo_file
                        (
                            setattr
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_files ((type ARG1))
                (allow ARG1 home_file
                    (file
                        (
                            setattr
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_lnk_files ((type ARG1))
                (allow ARG1 home_file
                    (lnk_file
                        (
                            setattr
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_sock_files ((type ARG1))
                (allow ARG1 home_file
                    (sock_file
                        (
                            setattr
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro write ((type ARG1))
                (allow ARG1 home_file
                    (files_except_blk_and_chr
                        (
                            write
                        )
                    )
                )
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_dirs ((type ARG1))
                (allow ARG1 home_file write_dir_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_fifo_files ((type ARG1))
                (allow ARG1 home_file write_fifo_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_files ((type ARG1))
                (allow ARG1 home_file write_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_lnk_files ((type ARG1))
                (allow ARG1 home_file write_lnk_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_sock_files ((type ARG1))
                (allow ARG1 home_file write_sock_file_perms)
                (call users.home_dir.search
                    (
                        ARG1
                    )
                )
            )

            ;
            ; users.home_file.obj_template policy
            ;

            (blockabstract obj_template)

            (blockinherit users.home_file.obj_stub)
        )
    )

    ;
    ; Users home_font name space
    ;

    (block home_font

        ;
        ; home_font macros
        ;

        (blockinherit obj_macro_template)

        (macro client_subj_type ((type ARG1))
            (typeattributeset client_subj_type_attribute ARG1)
        )

        ;
        ; home_font policy
        ;

        (typeattribute client_subj_type_attribute)
        (typeattribute obj_type_attribute)

        (call fs.xattr.getattr_fs
            (
                client_subj_type_attribute
            )
        )

        ;
        ; home_font templates
        ;

        (block obj_macro_template

            ;
            ; users.home_font.obj_macro_template macros
            ;

            (macro add_entries ((type ARG1))
                (allow ARG1 obj_type_attribute add_entry_dir_perms)
                (call users.home_font.cache.search
                    (
                        ARG1
                    )
                )
                (call users.home_font.config.search
                    (
                        ARG1
                    )
                )
                (call users.home_font.data.search
                    (
                        ARG1
                    )
                )
            )

            (macro append_files ((type ARG1))
                (allow ARG1 obj_type_attribute append_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro create ((type ARG1))
                (call create_dirs
                    (
                        ARG1
                    )
                )
                (call create_files
                    (
                        ARG1
                    )
                )
                (call create_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro create_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute create_dir_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_files ((type ARG1))
                (allow ARG1 obj_type_attribute create_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute create_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro del_entries ((type ARG1))
                (allow ARG1 obj_type_attribute del_entry_dir_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete ((type ARG1))
                (call delete_dirs
                    (
                        ARG1
                    )
                )
                (call delete_files
                    (
                        ARG1
                    )
                )
                (call delete_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro delete_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute delete_dir_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_files ((type ARG1))
                (allow ARG1 obj_type_attribute delete_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute delete_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro execute ((type ARG1))
                (allow ARG1 obj_type_attribute exec_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr ((type ARG1))
                (call getattr_dirs
                    (
                        ARG1
                    )
                )
                (call getattr_files
                    (
                        ARG1
                    )
                )
                (call getattr_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (dir
                        (
                            getattr
                        )
                    )
                )
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (file
                        (
                            getattr
                        )
                    )
                )
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (lnk_file
                        (
                            getattr
                        )
                    )
                )
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro list ((type ARG1))
                (allow ARG1 obj_type_attribute list_dir_perms)
                (call users.home_font.cache.search
                    (
                        ARG1
                    )
                )
                (call users.home_font.config.search
                    (
                        ARG1
                    )
                )
                (call users.home_font.data.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage ((type ARG1))
                (call manage_dirs
                    (
                        ARG1
                    )
                )
                (call manage_files
                    (
                        ARG1
                    )
                )
                (call manage_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro manage_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute manage_dir_perms)
                (call users.home_font.cache.search
                    (
                        ARG1
                    )
                )
                (call users.home_font.config.search
                    (
                        ARG1
                    )
                )
                (call users.home_font.data.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_files ((type ARG1))
                (allow ARG1 obj_type_attribute manage_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute manage_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro mmap ((type ARG1))
                (allow ARG1 obj_type_attribute mmap_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro obj_type ((type ARG1))
                (typeattributeset obj_type_attribute ARG1)
            )

            (macro read ((type ARG1))
                (call list
                    (
                        ARG1
                    )
                )
                (call read_files
                    (
                        ARG1
                    )
                )
                (call read_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro read_files ((type ARG1))
                (allow ARG1 obj_type_attribute read_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute read_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel ((type ARG1))
                (call relabel_dirs
                    (
                        ARG1
                    )
                )
                (call relabel_files
                    (
                        ARG1
                    )
                )
                (call relabel_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_dir_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom ((type ARG1))
                (call relabelfrom_dirs
                    (
                        ARG1
                    )
                )
                (call relabelfrom_files
                    (
                        ARG1
                    )
                )
                (call relabelfrom_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_dir_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto ((type ARG1))
                (call relabelto_dirs
                    (
                        ARG1
                    )
                )
                (call relabelto_files
                    (
                        ARG1
                    )
                )
                (call relabelto_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_dir_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename ((type ARG1))
                (call rename_dirs
                    (
                        ARG1
                    )
                )
                (call rename_files
                    (
                        ARG1
                    )
                )
                (call rename_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro rename_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute rename_dir_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_files ((type ARG1))
                (allow ARG1 obj_type_attribute rename_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute rename_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw ((type ARG1))
                (call rw_dirs
                    (
                        ARG1
                    )
                )
                (call rw_files
                    (
                        ARG1
                    )
                )
                (call rw_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro rw_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute rw_dir_perms)
                (call users.home_font.cache.search
                    (
                        ARG1
                    )
                )
                (call users.home_font.config.search
                    (
                        ARG1
                    )
                )
                (call users.home_font.data.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_files ((type ARG1))
                (allow ARG1 obj_type_attribute rw_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute rw_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro search ((type ARG1))
                (allow ARG1 obj_type_attribute search_dir_perms)
                (call users.home_font.cache.search
                    (
                        ARG1
                    )
                )
                (call users.home_font.config.search
                    (
                        ARG1
                    )
                )
                (call users.home_font.data.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr ((type ARG1))
                (call setattr_dirs
                    (
                        ARG1
                    )
                )
                (call setattr_files
                    (
                        ARG1
                    )
                )
                (call setattr_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (dir
                        (
                            setattr
                        )
                    )
                )
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (file
                        (
                            setattr
                        )
                    )
                )
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (lnk_file
                        (
                            setattr
                        )
                    )
                )
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro write ((type ARG1))
                (call write_dirs
                    (
                        ARG1
                    )
                )
                (call write_files
                    (
                        ARG1
                    )
                )
                (call write_lnk_files
                    (
                        ARG1
                    )
                )
            )

            (macro write_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute write_dir_perms)
                (call users.home_font.cache.search
                    (
                        ARG1
                    )
                )
                (call users.home_font.config.search
                    (
                        ARG1
                    )
                )
                (call users.home_font.data.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_files ((type ARG1))
                (allow ARG1 obj_type_attribute write_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute write_lnk_file_perms)
                (call users.generic_cache.search
                    (
                        ARG1
                    )
                )
                (call users.generic_config.search
                    (
                        ARG1
                    )
                )
                (call users.generic_data.search
                    (
                        ARG1
                    )
                )
            )

            ;
            ; users.home_font.obj_macro_template policy
            ;

            (blockabstract obj_macro_template)
        )

        ;
        ; Users home_font cache name space
        ;

        (block cache

            ;
            ; home_font cache contexts
            ;

            (filecon "HOME_DIR/\.fontconfig(/.*)?" any
                home_cache_file_context)
            (filecon "HOME_DIR/\.cache/fontconfig(/.*)?" any
                home_cache_file_context)

            ;
            ; home_font cache macros
            ;

            (macro generic_cache_obj_type_transition ((type ARG1))
                (call generic_cache.obj_type_transition
                    (
                        ARG1 home_cache_file dir "fontconfig"
                    )
                )
            )

            (macro home_dir_obj_type_transition ((type ARG1))
                (call home_dir.obj_type_transition
                    (
                        ARG1 home_cache_file dir ".fontconfig"
                    )
                )
            )

            ;
            ; home_font cache policy
            ;

            (blockinherit users.home_cache_file.obj_template)

            (call generic_cache.client_subj_type
                (
                    client_subj_type_attribute
                )
            )

            (call generic_cache_obj_type_transition
                (
                    client_subj_type_attribute
                )
            )

            (call home_dir_obj_type_transition
                (
                    client_subj_type_attribute
                )
            )

            (call manage
                (
                    client_subj_type_attribute
                )
            )

            (call obj_type
                (
                    home_cache_file
                )
            )
        )

        ;
        ; Users home_font config name space
        ;

        (block config

            ;
            ; home_font config contexts
            ;

            (filecon "HOME_DIR/\.fonts\.conf" file
                home_config_file_context)
            (filecon "HOME_DIR/\.fonts\.conf\.d(/.*)?" any
                home_config_file_context)
            (filecon "HOME_DIR/\.config/fontconfig(/.*)?" any
                home_config_file_context)

            ;
            ; home_font config macros
            ;

            (macro generic_config_obj_type_transition ((type ARG1))
                (call generic_config.obj_type_transition
                    (
                        ARG1 home_config_file dir "fontconfig"
                    )
                )
            )

            (macro home_dir_obj_type_transition ((type ARG1))
                (call home_dir.obj_type_transition
                    (
                        ARG1 home_config_file file ".fonts.conf"
                    )
                )
                (call home_dir.obj_type_transition
                    (
                        ARG1 home_config_file dir ".fonts.conf.d"
                    )
                )
            )

            ;
            ; home_font config policy
            ;

            (blockinherit users.home_config_file.obj_template)

            (call read
                (
                    client_subj_type_attribute
                )
            )
        )

        ;
        ; Users home_font data name space
        ;

        (block data

            ;
            ; home_font data contexts
            ;

            (filecon "HOME_DIR/\.fonts(/.*)?" any
                home_data_file_context)
            (filecon "HOME_DIR/\.local/share/fonts(/.*)?" any
                home_data_file_context)

            ;
            ; home_font data macros
            ;

            (macro generic_data_obj_type_transition ((type ARG1))
                (call generic_data.obj_type_transition
                    (
                        ARG1 home_data_file dir "fonts"
                    )
                )
            )

            (macro home_dir_obj_type_transition ((type ARG1))
                (call home_dir.obj_type_transition
                    (
                        ARG1 home_data_file dir ".fonts"
                    )
                )
            )

            ;
            ; home_font data policy
            ;

            (blockinherit users.home_data_file.obj_template)

            (call read
                (
                    client_subj_type_attribute
                )
            )
        )
    )

    ;
    ; Users home_history name space
    ;

    (block home_history

        ;
        ; home_history contexts
        ;

        (filecon "HOME_DIR/\.bash_history" file home_file_context)
        (filecon "HOME_DIR/\.python_history" file home_file_context)

        ;
        ; home_history macros
        ;

        (macro home_dir_obj_type_transition ((type ARG1))
            (call home_dir.obj_type_transition
                (
                    ARG1 home_file file ".bash_history"
                )
            )
            (call home_dir.obj_type_transition
                (
                    ARG1 home_file file ".python_history"
                )
            )
        )

        ;
        ; home_history policy
        ;

        (blockinherit home_file.obj_template)
    )

    ;
    ; Users home_shellrc name space
    ;

    (block home_shellrc

        ;
        ; home_shellrc contexts
        ;

        (filecon "HOME_DIR/\.bashrc" file home_file_context)
        (filecon "HOME_DIR/\.bash_logout" file home_file_context)
        (filecon "HOME_DIR/\.bash_profile" file home_file_context)
        (filecon "HOME_DIR/\.cshrc" file home_file_context)
        (filecon "HOME_DIR/\.tcshrc" file home_file_context)

        ;
        ; home_shellrc macros
        ;

        (macro home_dir_obj_type_transition ((type ARG1))
            (call home_dir.obj_type_transition
                (
                    ARG1 home_file file ".bashrc"
                )
            )
            (call home_dir.obj_type_transition
                (
                    ARG1 home_file file ".bash_logout"
                )
            )
            (call home_dir.obj_type_transition
                (
                    ARG1 home_file file ".bash_profile"
                )
            )
            (call home_dir.obj_type_transition
                (
                    ARG1 home_file file ".cshrc"
                )
            )
            (call home_dir.obj_type_transition
                (
                    ARG1 home_file file ".tcshrc"
                )
            )
        )

        ; home_shellrc policy
        ;
        ;

        (blockinherit home_file.obj_template)
    )

    ;
    ; Users mail_spool name space
    ;

    (block mail_spool

        ;
        ; mail_spool contexts
        ;

        (filecon "/var/spool/mail/%{USERNAME}" file var_spool_file_context)

        ;
        ; mail_spool macros
        ;

        (macro dontaudit_rw_files ((type ARG1))
            (dontaudit ARG1 var_spool_file rw_file_perms)
        )

        (macro append_files ((type ARG1))
            (allow ARG1 var_spool_file append_file_perms)
            (call files.generic_var_spool.search
                (
                    ARG1
                )
            )
        )

        (macro create_files ((type ARG1))
            (allow ARG1 var_spool_file create_file_perms)
            (call files.generic_var_spool.search
                (
                    ARG1
                )
            )
        )

        (macro delete_files ((type ARG1))
            (allow ARG1 var_spool_file delete_file_perms)
            (call files.generic_var_spool.search
                (
                    ARG1
                )
            )
        )

        (macro execute ((type ARG1))
            (allow ARG1 var_spool_file exec_file_perms)
            (call files.generic_var_spool.search
                (
                    ARG1
                )
            )
        )

        (macro getattr_files ((type ARG1))
            (allow ARG1 var_spool_file
                (file
                    (
                        getattr
                    )
                )
            )
            (call files.generic_var_spool.search
                (
                    ARG1
                )
            )
        )

        (macro manage_files ((type ARG1))
            (allow ARG1 var_spool_file manage_file_perms)
            (call files.generic_var_spool.search
                (
                    ARG1
                )
            )
        )

        (macro mmap ((type ARG1))
            (allow ARG1 var_spool_file mmap_file_perms)
            (call files.generic_var_spool.search
                (
                    ARG1
                )
            )
        )

        (macro read_files ((type ARG1))
            (allow ARG1 var_spool_file read_file_perms)
            (call files.generic_var_spool.search
                (
                    ARG1
                )
            )
        )

        (macro relabel_files ((type ARG1))
            (allow ARG1 var_spool_file relabel_file_perms)
            (call files.generic_var_spool.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_files ((type ARG1))
            (allow ARG1 var_spool_file relabelfrom_file_perms)
            (call files.generic_var_spool.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto_files ((type ARG1))
            (allow ARG1 var_spool_file relabelto_file_perms)
            (call files.generic_var_spool.search
                (
                    ARG1
                )
            )
        )

        (macro rename_files ((type ARG1))
            (allow ARG1 var_spool_file rename_file_perms)
            (call files.generic_var_spool.search
                (
                    ARG1
                )
            )
        )

        (macro rw_files ((type ARG1))
            (allow ARG1 var_spool_file rw_file_perms)
            (call files.generic_var_spool.search
                (
                    ARG1
                )
            )
        )

        (macro setattr_files ((type ARG1))
            (allow ARG1 var_spool_file
                (file
                    (
                        setattr
                    )
                )
            )
            (call files.generic_var_spool.search
                (
                    ARG1
                )
            )
        )

        (macro generic_var_spool_obj_type_transition ((type ARG1))
            (call files.generic_var_spool.obj_type_transition
                (
                    ARG1 var_spool_file file "*"
                )
            )
        )

        (macro write_files ((type ARG1))
            (allow ARG1 var_spool_file write_file_perms)
            (call files.generic_var_spool.search
                (
                    ARG1
                )
            )
        )

        ;
        ; mail_spool policy
        ;

        (blockinherit files.var_spool_file.obj_stub)
    )

    ;
    ; Users priv_login_user name space
    ;

    (block priv_login_user

        ;
        ; priv_login_user macros
        ;

        (blockinherit common_user.subj_macro_template)

        ;
        ; priv_login_user policy
        ;

        (blockinherit subj_policy_template)

        ;
        ; priv_login_user templates
        ;

        (block subj_policy_template

            ;
            ; users.priv_login_user.subj_policy_template policy
            ;

            (blockabstract subj_policy_template)

            (typeattribute subj_type_attribute)

            (call ibac_obj_id_change_exemption_subj_type
                (
                    subj_type_attribute
                )
            )

            (call rbac_obj_role_change_exemption_subj_type
                (
                    subj_type_attribute
                )
            )
        )

        (block subj_template

            ;
            ; users.priv_login_user.subj_template policy
            ;

            (blockabstract subj_template)

            (blockinherit users.priv_user.subj_template)

            (user id)
            (userrole id role)

            (userlevel id systemlow)
            (userrange id
                (
                    systemlow
                    systemlow
                )
            )

            (call users.priv_login_user.subj_type
                (
                    subj
                )
            )

            (call sys.roleallow_role
                (
                    role
                )
            )
        )
    )

    ;
    ; Users priv_user name space
    ;

    (block priv_user

        ;
        ; priv_user macros
        ;

        (blockinherit common_user.subj_macro_template)

        ;
        ; priv_user policy
        ;

        (blockinherit subj_policy_template)

        ;
        ; priv_user templates
        ;

        (block subj_policy_template

            ;
            ; users.priv_user.subj_policy.template policy
            ;

            (blockabstract subj_policy_template)

            (typeattribute subj_type_attribute)

            (allow subj_type_attribute self
                (capability
                    (
                        dac_override
                    )
                )
            )

            (call users.home_file.dontaudit_rw
                (
                    subj_type_attribute
                )
            )

            (call users.mail_spool.dontaudit_rw_files
                (
                    subj_type_attribute
                )
            )

            (call users.unpriv_user.rw_inherited_fifo_files
                (
                    subj_type_attribute
                )
            )

            (call users.unpriv_user.rw_inherited_unix_stream_sockets
                (
                    subj_type_attribute
                )
            )
        )

        (block subj_template

            ;
            ; users.priv_user.subj_template policy
            ;

            (blockabstract subj_template)

            (blockinherit users.common_user.subj_template)

            (call users.priv_user.subj_type
                (
                    subj
                )
            )

            (call rbacsep_exemption_role
                (
                    role
                )
            )
        )
    )

    ;
    ; Users terminals name space
    ;

    (block terminals

        ;
        ; terminals macros
        ;

        (macro create_chr_files ((type ARG1))
            (allow ARG1 obj_type_attribute create_chr_file_perms)
            (call fs.devpts.search
                (
                    ARG1
                )
            )
        )

        (macro delete_chr_files ((type ARG1))
            (allow ARG1 obj_type_attribute delete_chr_file_perms)
            (call fs.devpts.search
                (
                    ARG1
                )
            )
        )

        (macro getattr_chr_files ((type ARG1))
            (allow ARG1 obj_type_attribute
                (chr_file
                    (
                        getattr
                    )
                )
            )
            (call fs.devpts.search
                (
                    ARG1
                )
            )
        )

        (macro manage_chr_files ((type ARG1))
            (allow ARG1 obj_type_attribute manage_chr_file_perms)
            (call fs.devpts.search
                (
                    ARG1
                )
            )
        )

        (macro obj_type ((type ARG1))
            (typeattributeset obj_type_attribute ARG1)
        )

        (macro relabel_chr_files ((type ARG1))
            (allow ARG1 obj_type_attribute relabel_chr_file_perms)
            (call fs.devpts.search
                (
                    ARG1
                )
            )
        )

        (macro relabelfrom_chr_files ((type ARG1))
            (allow ARG1 obj_type_attribute relabelfrom_chr_file_perms)
            (call fs.devpts.search
                (
                    ARG1
                )
            )
        )

        (macro relabelto_chr_files ((type ARG1))
            (allow ARG1 obj_type_attribute relabelto_chr_file_perms)
            (call fs.devpts.search
                (
                    ARG1
                )
            )
        )

        (macro rename_chr_files ((type ARG1))
            (allow ARG1 obj_type_attribute rename_chr_file_perms)
            (call fs.devpts.search
                (
                    ARG1
                )
            )
        )

        (macro rw_chr_files ((type ARG1))
            (allow ARG1 obj_type_attribute rw_term_perms)
            (call fs.devpts.search
                (
                    ARG1
                )
            )
        )

        (macro rw_inherited_chr_files ((type ARG1))
            (allow ARG1 obj_type_attribute rw_inherited_term_perms)
        )

        (macro setattr_chr_files ((type ARG1))
            (allow ARG1 obj_type_attribute
                (chr_file
                    (
                        setattr
                    )
                )
            )
            (call fs.devpts.search
                (
                    ARG1
                )
            )
        )

        (macro write_chr_files ((type ARG1))
            (allow ARG1 obj_type_attribute write_chr_file_perms)
            (call fs.devpts.search
                (
                    ARG1
                )
            )
        )

        ;
        ; terminals policy
        ;

        (typeattribute obj_type_attribute)

        ;
        ; Users terminals pty name space
        ;

        (block pty

            ;
            ; terminals pty macros
            ;

            (macro dontaudit_relabelfrom_chr_files ((type ARG1))
                (dontaudit ARG1 pty_file relabelfrom_chr_file_perms)
            )

            (macro create_pty ((type ARG1))
                (call term.pty_file.create_pty
                    (
                        ARG1 pty_file
                    )
                )
            )

            (macro user_pty ((type ARG1))
                (call term.login_pty_file.user_pty
                    (
                        ARG1 pty_file
                    )
                )
            )

            ;
            ; terminals pty policy
            ;

            (blockinherit term.pty_file.obj_template)

            (call terminals.obj_type
                (
                    pty_file
                )
            )
        )

        ;
        ; Users terminals tty name space
        ;

        (block tty

            ;
            ; terminals tty macros
            ;

            (macro dontaudit_relabelfrom_chr_files ((type ARG1))
                (dontaudit ARG1 serial_file relabelfrom_chr_file_perms)
            )

            (macro user_tty ((type ARG1))
                (call term.generic_serial.user_tty
                    (
                        ARG1 serial_file
                    )
                )
            )

            ;
            ; terminals tty policy
            ;

            (blockinherit term.serial_file.obj_template)

            (call terminals.obj_type
                (
                    serial_file
                )
            )
        )
    )

    ;
    ; Users unpriv_login_user name space
    ;

    (block unpriv_login_user

        ;
        ; unpriv_login_user macros
        ;

        (blockinherit common_user.subj_macro_template)

        ;
        ; unpriv_login_user policy
        ;

        (typeattribute subj_type_attribute)

        ;
        ; unpriv_login_user templates
        ;

        (block subj_template

            ;
            ; users.unpriv_login_user.subj_template policy
            ;

            (blockabstract subj_template)

            (blockinherit users.unpriv_user.subj_template)

            (user id)
            (userrole id role)

            (userlevel id systemlow)
            (userrange id
                (
                    systemlow
                    systemlow
                )
            )

            (call users.unpriv_login_user.subj_type
                (
                    subj
                )
            )

            (call sys.roleallow_role
                (
                    role
                )
            )
        )
    )

    ;
    ; Users unpriv_user name space
    ;

    (block unpriv_user

        ;
        ; unpriv_user macros
        ;

        (blockinherit common_user.subj_macro_template)

        ;
        ; unpriv_user policy
        ;

        (typeattribute subj_type_attribute)

        ;
        ; unpriv_user templates
        ;

        (block subj_template

            ;
            ; users.unpriv_user.subj_template policy
            ;

            (blockabstract subj_template)

            (blockinherit users.common_user.subj_template)

            (call users.unpriv_user.subj_type
                (
                    subj
                )
            )
        )
    )

    ;
    ; Users user_tmp_file name space
    ;

    (block user_tmp_file

        ;
        ; user_tmp_file macros
        ;

        (blockinherit obj_macro_template)

        ;
        ; user_tmp_file policy
        ;

        (typeattribute obj_type_attribute)

        (call files.var_tmp_file.obj_type
            (
                obj_type_attribute
            )
        )

        ;
        ; user_tmp_file templates
        ;

        (block obj_macro_template

            ;
            ; users.user_tmp_file.obj_macro_template macros
            ;

            (macro add_entries ((type ARG1))
                (allow ARG1 obj_type_attribute add_entry_dir_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro append_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute append_fifo_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro append_files ((type ARG1))
                (allow ARG1 obj_type_attribute append_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro create ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            create
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute create_dir_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute create_fifo_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_files ((type ARG1))
                (allow ARG1 obj_type_attribute create_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute create_lnk_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute create_sock_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro del_entries ((type ARG1))
                (allow ARG1 obj_type_attribute del_entry_dir_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            delete
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute delete_dir_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute delete_fifo_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_files ((type ARG1))
                (allow ARG1 obj_type_attribute delete_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute delete_lnk_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute delete_sock_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro execute ((type ARG1))
                (allow ARG1 obj_type_attribute exec_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            getattr
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (dir
                        (
                            getattr
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (fifo_file
                        (
                            getattr
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (file
                        (
                            getattr
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (lnk_file
                        (
                            getattr
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (sock_file
                        (
                            getattr
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro list ((type ARG1))
                (allow ARG1 obj_type_attribute list_dir_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            manage
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute manage_dir_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute manage_fifo_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_files ((type ARG1))
                (allow ARG1 obj_type_attribute manage_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute manage_lnk_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute manage_sock_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro mmap ((type ARG1))
                (allow ARG1 obj_type_attribute mmap_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro obj_type ((type ARG1))
                (typeattributeset obj_type_attribute ARG1)
            )

            (macro read ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            read
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute read_fifo_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_files ((type ARG1))
                (allow ARG1 obj_type_attribute read_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute read_lnk_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute read_sock_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            relabel
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_dir_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_fifo_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_lnk_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_sock_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            relabelfrom
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_dir_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_fifo_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_lnk_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_sock_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            relabelto
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_dir_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_fifo_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_lnk_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_sock_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            rename
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute rename_dir_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute rename_fifo_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_files ((type ARG1))
                (allow ARG1 obj_type_attribute rename_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute rename_lnk_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute rename_sock_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            rw
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute rw_dir_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute rw_fifo_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_files ((type ARG1))
                (allow ARG1 obj_type_attribute rw_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute rw_lnk_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute rw_sock_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro search ((type ARG1))
                (allow ARG1 obj_type_attribute search_dir_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            setattr
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (dir
                        (
                            setattr
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (fifo_file
                        (
                            setattr
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (file
                        (
                            setattr
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (lnk_file
                        (
                            setattr
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (sock_file
                        (
                            setattr
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro write ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            write
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute write_dir_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute write_fifo_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_files ((type ARG1))
                (allow ARG1 obj_type_attribute write_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute write_lnk_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute write_sock_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            ;
            ; users.user_tmp_file.obj_macro_template policy
            ;

            (blockabstract obj_macro_template)
        )

        (block obj_stub

            ;
            ; users.user_tmp_file.obj_stub contexts
            ;

            (context user_tmp_file_context
                (
                    sys.id
                    sys.role
                    user_tmp_file
                        (
                            systemlow
                            systemlow
                        )
                )
            )

            ;
            ; users.user_tmp_file.obj_stub policy
            ;

            (blockabstract obj_stub)

            (type user_tmp_file)
            (call users.user_tmp_file.obj_type
                (
                    user_tmp_file
                )
            )
        )

        (block obj_template

            ;
            ; users.user_tmp_file.obj_template macros
            ;

            (macro add_entries ((type ARG1))
                (allow ARG1 user_tmp_file add_entry_dir_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro append_fifo_files ((type ARG1))
                (allow ARG1 user_tmp_file append_fifo_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro append_files ((type ARG1))
                (allow ARG1 user_tmp_file append_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro create ((type ARG1))
                (allow ARG1 user_tmp_file
                    (files_except_blk_and_chr
                        (
                            create
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_dirs ((type ARG1))
                (allow ARG1 user_tmp_file create_dir_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_fifo_files ((type ARG1))
                (allow ARG1 user_tmp_file create_fifo_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_files ((type ARG1))
                (allow ARG1 user_tmp_file create_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_lnk_files ((type ARG1))
                (allow ARG1 user_tmp_file create_lnk_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_sock_files ((type ARG1))
                (allow ARG1 user_tmp_file create_sock_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro del_entries ((type ARG1))
                (allow ARG1 user_tmp_file del_entry_dir_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete ((type ARG1))
                (allow ARG1 user_tmp_file
                    (files_except_blk_and_chr
                        (
                            delete
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_dirs ((type ARG1))
                (allow ARG1 user_tmp_file delete_dir_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_fifo_files ((type ARG1))
                (allow ARG1 user_tmp_file delete_fifo_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_files ((type ARG1))
                (allow ARG1 user_tmp_file delete_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_lnk_files ((type ARG1))
                (allow ARG1 user_tmp_file delete_lnk_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_sock_files ((type ARG1))
                (allow ARG1 user_tmp_file delete_sock_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro execute ((type ARG1))
                (allow ARG1 user_tmp_file exec_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr ((type ARG1))
                (allow ARG1 user_tmp_file
                    (files_except_blk_and_chr
                        (
                            getattr
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_dirs ((type ARG1))
                (allow ARG1 user_tmp_file
                    (dir
                        (
                            getattr
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_fifo_files ((type ARG1))
                (allow ARG1 user_tmp_file
                    (fifo_file
                        (
                            getattr
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_files ((type ARG1))
                (allow ARG1 user_tmp_file
                    (file
                        (
                            getattr
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_lnk_files ((type ARG1))
                (allow ARG1 user_tmp_file
                    (lnk_file
                        (
                            getattr
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_sock_files ((type ARG1))
                (allow ARG1 user_tmp_file
                    (sock_file
                        (
                            getattr
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro list ((type ARG1))
                (allow ARG1 user_tmp_file list_dir_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage ((type ARG1))
                (allow ARG1 user_tmp_file
                    (files_except_blk_and_chr
                        (
                            manage
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_dirs ((type ARG1))
                (allow ARG1 user_tmp_file manage_dir_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_fifo_files ((type ARG1))
                (allow ARG1 user_tmp_file manage_fifo_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_files ((type ARG1))
                (allow ARG1 user_tmp_file manage_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_lnk_files ((type ARG1))
                (allow ARG1 user_tmp_file manage_lnk_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_sock_files ((type ARG1))
                (allow ARG1 user_tmp_file manage_sock_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro mmap ((type ARG1))
                (allow ARG1 user_tmp_file mmap_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
                (typetransition ARG1 user_tmp_file ARG3 ARG4 ARG2)
                    (call rw_dirs
                    (
                        ARG1
                    )
                )
            )

            (macro read ((type ARG1))
                (allow ARG1 user_tmp_file
                    (files_except_blk_and_chr
                        (
                            read
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_fifo_files ((type ARG1))
                (allow ARG1 user_tmp_file read_fifo_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_files ((type ARG1))
                (allow ARG1 user_tmp_file read_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_lnk_files ((type ARG1))
                (allow ARG1 user_tmp_file read_lnk_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_sock_files ((type ARG1))
                (allow ARG1 user_tmp_file read_sock_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel ((type ARG1))
                (allow ARG1 user_tmp_file
                    (files_except_blk_and_chr
                        (
                            relabel
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_dirs ((type ARG1))
                (allow ARG1 user_tmp_file relabel_dir_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_fifo_files ((type ARG1))
                (allow ARG1 user_tmp_file relabel_fifo_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_files ((type ARG1))
                (allow ARG1 user_tmp_file relabel_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_lnk_files ((type ARG1))
                (allow ARG1 user_tmp_file relabel_lnk_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_sock_files ((type ARG1))
                (allow ARG1 user_tmp_file relabel_sock_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom ((type ARG1))
                (allow ARG1 user_tmp_file
                    (files_except_blk_and_chr
                        (
                            relabelfrom
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_dirs ((type ARG1))
                (allow ARG1 user_tmp_file relabelfrom_dir_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_fifo_files ((type ARG1))
                (allow ARG1 user_tmp_file relabelfrom_fifo_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_files ((type ARG1))
                (allow ARG1 user_tmp_file relabelfrom_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_lnk_files ((type ARG1))
                (allow ARG1 user_tmp_file relabelfrom_lnk_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_sock_files ((type ARG1))
                (allow ARG1 user_tmp_file relabelfrom_sock_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto ((type ARG1))
                (allow ARG1 user_tmp_file
                    (files_except_blk_and_chr
                        (
                            relabelto
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_dirs ((type ARG1))
                (allow ARG1 user_tmp_file relabelto_dir_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_fifo_files ((type ARG1))
                (allow ARG1 user_tmp_file relabelto_fifo_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_files ((type ARG1))
                (allow ARG1 user_tmp_file relabelto_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_lnk_files ((type ARG1))
                (allow ARG1 user_tmp_file relabelto_lnk_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_sock_files ((type ARG1))
                (allow ARG1 user_tmp_file relabelto_sock_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename ((type ARG1))
                (allow ARG1 user_tmp_file
                    (files_except_blk_and_chr
                        (
                            rename
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_dirs ((type ARG1))
                (allow ARG1 user_tmp_file rename_dir_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_fifo_files ((type ARG1))
                (allow ARG1 user_tmp_file rename_fifo_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_files ((type ARG1))
                (allow ARG1 user_tmp_file rename_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_lnk_files ((type ARG1))
                (allow ARG1 user_tmp_file rename_lnk_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_sock_files ((type ARG1))
                (allow ARG1 user_tmp_file rename_sock_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw ((type ARG1))
                (allow ARG1 user_tmp_file
                    (files_except_blk_and_chr
                        (
                            rw
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_dirs ((type ARG1))
                (allow ARG1 user_tmp_file rw_dir_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_fifo_files ((type ARG1))
                (allow ARG1 user_tmp_file rw_fifo_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_files ((type ARG1))
                (allow ARG1 user_tmp_file rw_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_lnk_files ((type ARG1))
                (allow ARG1 user_tmp_file rw_lnk_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_sock_files ((type ARG1))
                (allow ARG1 user_tmp_file rw_sock_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro search ((type ARG1))
                (allow ARG1 user_tmp_file search_dir_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr ((type ARG1))
                (allow ARG1 user_tmp_file
                    (files_except_blk_and_chr
                        (
                            setattr
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_dirs ((type ARG1))
                (allow ARG1 user_tmp_file
                    (dir
                        (
                            setattr
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_fifo_files ((type ARG1))
                (allow ARG1 user_tmp_file
                    (fifo_file
                        (
                            setattr
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_files ((type ARG1))
                (allow ARG1 user_tmp_file
                    (file
                        (
                            setattr
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_lnk_files ((type ARG1))
                (allow ARG1 user_tmp_file
                    (lnk_file
                        (
                            setattr
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_sock_files ((type ARG1))
                (allow ARG1 user_tmp_file
                    (sock_file
                        (
                            setattr
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro write ((type ARG1))
                (allow ARG1 user_tmp_file
                    (files_except_blk_and_chr
                        (
                            write
                        )
                    )
                )
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_dirs ((type ARG1))
                (allow ARG1 user_tmp_file write_dir_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_fifo_files ((type ARG1))
                (allow ARG1 user_tmp_file write_fifo_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_files ((type ARG1))
                (allow ARG1 user_tmp_file write_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_lnk_files ((type ARG1))
                (allow ARG1 user_tmp_file write_lnk_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_sock_files ((type ARG1))
                (allow ARG1 user_tmp_file write_sock_file_perms)
                (call files.generic_var_tmp.search
                    (
                        ARG1
                    )
                )
            )

            ;
            ; users.user_tmp_file.obj_template policy
            ;

            (blockabstract obj_template)

            (blockinherit users.user_tmp_file.obj_stub)
        )
    )

    ;
    ; Users user_tmpfs_file name space
    ;

    (block user_tmpfs_file

        ;
        ; user_tmpfs_file macros
        ;

        (blockinherit obj_macro_template)

        ;
        ; user_tmpfs_file policy
        ;

        (typeattribute obj_type_attribute)

        (call files.tmpfs_file.obj_type
            (
                obj_type_attribute
            )
        )

        ;
        ; user_tmpfs_file templates
        ;

        (block obj_macro_template

            ;
            ; users.user_tmpfs_file.obj_macro_template macros
            ;

            (macro add_entries ((type ARG1))
                (allow ARG1 obj_type_attribute add_entry_dir_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro append_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute append_fifo_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro append_files ((type ARG1))
                (allow ARG1 obj_type_attribute append_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro create ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            create
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute create_dir_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute create_fifo_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_files ((type ARG1))
                (allow ARG1 obj_type_attribute create_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute create_lnk_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute create_sock_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro del_entries ((type ARG1))
                (allow ARG1 obj_type_attribute del_entry_dir_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            delete
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute delete_dir_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute delete_fifo_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_files ((type ARG1))
                (allow ARG1 obj_type_attribute delete_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute delete_lnk_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute delete_sock_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro execute ((type ARG1))
                (allow ARG1 obj_type_attribute exec_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            getattr
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (dir
                        (
                            getattr
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (fifo_file
                        (
                            getattr
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (file
                        (
                            getattr
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (lnk_file
                        (
                            getattr
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (sock_file
                        (
                            getattr
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro list ((type ARG1))
                (allow ARG1 obj_type_attribute list_dir_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            manage
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute manage_dir_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute manage_fifo_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_files ((type ARG1))
                (allow ARG1 obj_type_attribute manage_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute manage_lnk_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute manage_sock_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro mmap ((type ARG1))
                (allow ARG1 obj_type_attribute mmap_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro obj_type ((type ARG1))
                (typeattributeset obj_type_attribute ARG1)
            )

            (macro read ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            read
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute read_fifo_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_files ((type ARG1))
                (allow ARG1 obj_type_attribute read_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute read_lnk_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute read_sock_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            relabel
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_dir_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_fifo_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_lnk_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabel_sock_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            relabelfrom
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_dir_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_fifo_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_lnk_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelfrom_sock_file_perms)
                 (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            relabelto
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_dir_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_fifo_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_lnk_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute relabelto_sock_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            rename
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute rename_dir_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute rename_fifo_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_files ((type ARG1))
                (allow ARG1 obj_type_attribute rename_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute rename_lnk_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute rename_sock_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            rw
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute rw_dir_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute rw_fifo_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_files ((type ARG1))
                (allow ARG1 obj_type_attribute rw_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute rw_lnk_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute rw_sock_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro search ((type ARG1))
                (allow ARG1 obj_type_attribute search_dir_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            setattr
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (dir
                        (
                            setattr
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (fifo_file
                        (
                            setattr
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (file
                        (
                            setattr
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (lnk_file
                        (
                            setattr
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (sock_file
                        (
                            setattr
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro write ((type ARG1))
                (allow ARG1 obj_type_attribute
                    (files_except_blk_and_chr
                        (
                            write
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_dirs ((type ARG1))
                (allow ARG1 obj_type_attribute write_dir_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_fifo_files ((type ARG1))
                (allow ARG1 obj_type_attribute write_fifo_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_files ((type ARG1))
                (allow ARG1 obj_type_attribute write_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_lnk_files ((type ARG1))
                (allow ARG1 obj_type_attribute write_lnk_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_sock_files ((type ARG1))
                (allow ARG1 obj_type_attribute write_sock_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            ;
            ; users.user_tmpfs_file.obj_macro_template policy
            ;

            (blockabstract obj_macro_template)
        )

        (block obj_stub

            ;
            ; users.user_tmpfs_file.obj_stub contexts
            ;

            (context user_tmpfs_file_context
                (
                    sys.id
                    sys.role
                    user_tmpfs_file
                        (
                            systemlow
                            systemlow
                        )
                )
            )

            ;
            ; users.user_tmpfs_file.obj_stub policy
            ;

            (blockabstract obj_stub)

            (type user_tmpfs_file)
            (call users.user_tmpfs_file.obj_type
                (
                    user_tmpfs_file
                )
            )
        )

        (block obj_template

            ;
            ; users.user_tmpfs_file.obj_template macros
            ;

            (macro add_entries ((type ARG1))
                (allow ARG1 user_tmpfs_file add_entry_dir_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro append_fifo_files ((type ARG1))
                (allow ARG1 user_tmpfs_file append_fifo_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro append_files ((type ARG1))
                (allow ARG1 user_tmpfs_file append_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro create ((type ARG1))
                (allow ARG1 user_tmpfs_file
                    (files_except_blk_and_chr
                        (
                            create
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_dirs ((type ARG1))
                (allow ARG1 user_tmpfs_file create_dir_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_fifo_files ((type ARG1))
                (allow ARG1 user_tmpfs_file create_fifo_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_files ((type ARG1))
                (allow ARG1 user_tmpfs_file create_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_lnk_files ((type ARG1))
                (allow ARG1 user_tmpfs_file create_lnk_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro create_sock_files ((type ARG1))
                (allow ARG1 user_tmpfs_file create_sock_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro del_entries ((type ARG1))
                (allow ARG1 user_tmpfs_file del_entry_dir_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete ((type ARG1))
                (allow ARG1 user_tmpfs_file
                    (files_except_blk_and_chr
                        (
                            delete
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_dirs ((type ARG1))
                (allow ARG1 user_tmpfs_file delete_dir_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_fifo_files ((type ARG1))
                (allow ARG1 user_tmpfs_file delete_fifo_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_files ((type ARG1))
                (allow ARG1 user_tmpfs_file delete_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_lnk_files ((type ARG1))
                (allow ARG1 user_tmpfs_file delete_lnk_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro delete_sock_files ((type ARG1))
                (allow ARG1 user_tmpfs_file delete_sock_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro execute ((type ARG1))
                (allow ARG1 user_tmpfs_file exec_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr ((type ARG1))
                (allow ARG1 user_tmpfs_file
                    (files_except_blk_and_chr
                        (
                            getattr
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_dirs ((type ARG1))
                (allow ARG1 user_tmpfs_file
                    (dir
                        (
                            getattr
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_fifo_files ((type ARG1))
                (allow ARG1 user_tmpfs_file
                    (fifo_file
                        (
                            getattr
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_files ((type ARG1))
                (allow ARG1 user_tmpfs_file
                    (file
                        (
                            getattr
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_lnk_files ((type ARG1))
                (allow ARG1 user_tmpfs_file
                    (lnk_file
                        (
                            getattr
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro getattr_sock_files ((type ARG1))
                (allow ARG1 user_tmpfs_file
                    (sock_file
                        (
                            getattr
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro list ((type ARG1))
                (allow ARG1 user_tmpfs_file list_dir_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage ((type ARG1))
                (allow ARG1 user_tmpfs_file
                    (files_except_blk_and_chr
                        (
                            manage
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_dirs ((type ARG1))
                (allow ARG1 user_tmpfs_file manage_dir_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_fifo_files ((type ARG1))
                (allow ARG1 user_tmpfs_file manage_fifo_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_files ((type ARG1))
                (allow ARG1 user_tmpfs_file manage_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_lnk_files ((type ARG1))
                (allow ARG1 user_tmpfs_file manage_lnk_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro manage_sock_files ((type ARG1))
                (allow ARG1 user_tmpfs_file manage_sock_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro mmap ((type ARG1))
                (allow ARG1 user_tmpfs_file mmap_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
                (typetransition ARG1 user_tmpfs_file ARG3 ARG4 ARG2)
                    (call rw_dirs
                    (
                        ARG1
                    )
                )
            )

            (macro read ((type ARG1))
                (allow ARG1 user_tmpfs_file
                    (files_except_blk_and_chr
                        (
                            read
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_fifo_files ((type ARG1))
                (allow ARG1 user_tmpfs_file read_fifo_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_files ((type ARG1))
                (allow ARG1 user_tmpfs_file read_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_lnk_files ((type ARG1))
                (allow ARG1 user_tmpfs_file read_lnk_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro read_sock_files ((type ARG1))
                (allow ARG1 user_tmpfs_file read_sock_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel ((type ARG1))
                (allow ARG1 user_tmpfs_file
                    (files_except_blk_and_chr
                        (
                            relabel
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_dirs ((type ARG1))
                (allow ARG1 user_tmpfs_file relabel_dir_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_fifo_files ((type ARG1))
                (allow ARG1 user_tmpfs_file relabel_fifo_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_files ((type ARG1))
                (allow ARG1 user_tmpfs_file relabel_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_lnk_files ((type ARG1))
                (allow ARG1 user_tmpfs_file relabel_lnk_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabel_sock_files ((type ARG1))
                (allow ARG1 user_tmpfs_file relabel_sock_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom ((type ARG1))
                (allow ARG1 user_tmpfs_file
                    (files_except_blk_and_chr
                        (
                            relabelfrom
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_dirs ((type ARG1))
                (allow ARG1 user_tmpfs_file relabelfrom_dir_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_fifo_files ((type ARG1))
                (allow ARG1 user_tmpfs_file relabelfrom_fifo_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_files ((type ARG1))
                (allow ARG1 user_tmpfs_file relabelfrom_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_lnk_files ((type ARG1))
                (allow ARG1 user_tmpfs_file relabelfrom_lnk_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelfrom_sock_files ((type ARG1))
                (allow ARG1 user_tmpfs_file relabelfrom_sock_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto ((type ARG1))
                (allow ARG1 user_tmpfs_file
                    (files_except_blk_and_chr
                        (
                            relabelto
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_dirs ((type ARG1))
                (allow ARG1 user_tmpfs_file relabelto_dir_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_fifo_files ((type ARG1))
                (allow ARG1 user_tmpfs_file relabelto_fifo_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_files ((type ARG1))
                (allow ARG1 user_tmpfs_file relabelto_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_lnk_files ((type ARG1))
                (allow ARG1 user_tmpfs_file relabelto_lnk_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro relabelto_sock_files ((type ARG1))
                (allow ARG1 user_tmpfs_file relabelto_sock_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename ((type ARG1))
                (allow ARG1 user_tmpfs_file
                    (files_except_blk_and_chr
                        (
                            rename
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_dirs ((type ARG1))
                (allow ARG1 user_tmpfs_file rename_dir_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_fifo_files ((type ARG1))
                (allow ARG1 user_tmpfs_file rename_fifo_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_files ((type ARG1))
                (allow ARG1 user_tmpfs_file rename_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_lnk_files ((type ARG1))
                (allow ARG1 user_tmpfs_file rename_lnk_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro rename_sock_files ((type ARG1))
                (allow ARG1 user_tmpfs_file rename_sock_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw ((type ARG1))
                (allow ARG1 user_tmpfs_file
                    (files_except_blk_and_chr
                        (
                            rw
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_dirs ((type ARG1))
                (allow ARG1 user_tmpfs_file rw_dir_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_fifo_files ((type ARG1))
                (allow ARG1 user_tmpfs_file rw_fifo_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_files ((type ARG1))
                (allow ARG1 user_tmpfs_file rw_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_lnk_files ((type ARG1))
                (allow ARG1 user_tmpfs_file rw_lnk_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro rw_sock_files ((type ARG1))
                (allow ARG1 user_tmpfs_file rw_sock_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro search ((type ARG1))
                (allow ARG1 user_tmpfs_file search_dir_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr ((type ARG1))
                (allow ARG1 user_tmpfs_file
                    (files_except_blk_and_chr
                        (
                            setattr
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_dirs ((type ARG1))
                (allow ARG1 user_tmpfs_file
                    (dir
                        (
                            setattr
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_fifo_files ((type ARG1))
                (allow ARG1 user_tmpfs_file
                    (fifo_file
                        (
                            setattr
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_files ((type ARG1))
                (allow ARG1 user_tmpfs_file
                    (file
                        (
                            setattr
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_lnk_files ((type ARG1))
                (allow ARG1 user_tmpfs_file
                    (lnk_file
                        (
                            setattr
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro setattr_sock_files ((type ARG1))
                (allow ARG1 user_tmpfs_file
                    (sock_file
                        (
                            setattr
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro write ((type ARG1))
                (allow ARG1 user_tmpfs_file
                    (files_except_blk_and_chr
                        (
                            write
                        )
                    )
                )
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_dirs ((type ARG1))
                (allow ARG1 user_tmpfs_file write_dir_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_fifo_files ((type ARG1))
                (allow ARG1 user_tmpfs_file write_fifo_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_files ((type ARG1))
                (allow ARG1 user_tmpfs_file write_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_lnk_files ((type ARG1))
                (allow ARG1 user_tmpfs_file write_lnk_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            (macro write_sock_files ((type ARG1))
                (allow ARG1 user_tmpfs_file write_sock_file_perms)
                (call files.runtime_user.search
                    (
                        ARG1
                    )
                )
                (call fs.tmpfs.search
                    (
                        ARG1
                    )
                )
            )

            ;
            ; users.user_tmpfs_file.obj_template policy
            ;

            (blockabstract obj_template)

            (blockinherit users.user_tmpfs_file.obj_stub)
        )
    )
)
